<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portail Secrétaire - Eden Family School</title>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    :root {
      --primary: #2c3e50;
      --primary-light: #34495e;
      --secondary: #3498db;
      --secondary-light: #5dade2;
      --accent: #16a085;
      --accent-light: #1abc9c;
      --success: #27ae60;
      --danger: #e74c3c;
      --warning: #f39c12;
      --info: #3498db;
      --light: #ecf0f1;
      --dark: #2c3e50;
      --gray: #7f8c8d;
      --gray-light: #bdc3c7;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, var(--light) 0%, #dfe6e9 100%);
      min-height: 100vh;
      padding: 20px 0;
      color: var(--dark);
      display: flex;
      flex-direction: column;
    }
    
    .navbar {
      background: white !important;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 15px rgba(44, 62, 80, 0.08);
      border-radius: 12px;
      margin: 0 20px 20px 20px;
      border: 1px solid rgba(189, 195, 199, 0.2);
    }
    
    .navbar-brand {
      font-weight: 700;
      font-size: 1.5rem;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .main-container {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(44, 62, 80, 0.1);
      margin: 0 20px 20px 20px;
      border: 1px solid rgba(189, 195, 199, 0.3);
      flex: 1;
    }
    
    .sidebar {
      background: linear-gradient(160deg, var(--primary) 0%, var(--primary-light) 100%);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 20px rgba(44, 62, 80, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .sidebar .list-group-item {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 8px;
      border-radius: 10px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      font-weight: 500;
    }
    
    .sidebar .list-group-item:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateX(5px);
      border-color: rgba(255, 255, 255, 0.2);
    }
    
    .sidebar .list-group-item.active {
      background: white;
      color: var(--primary);
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(44, 62, 80, 0.15);
      border: 1px solid white;
    }
    
    .stat-card {
      background: white;
      border-radius: 14px;
      padding: 20px;
      color: var(--dark);
      text-align: center;
      margin-bottom: 15px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      border: 1px solid rgba(189, 195, 199, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--secondary);
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(44, 62, 80, 0.12);
      border-color: var(--secondary-light);
    }
    
    .stat-card.students::before {
      background: linear-gradient(90deg, var(--secondary), var(--secondary-light));
    }
    
    .stat-card.teachers::before {
      background: linear-gradient(90deg, var(--accent), var(--accent-light));
    }
    
    .stat-card.assignments::before {
      background: linear-gradient(90deg, var(--warning), #f1c40f);
    }
    
    .stat-card.books::before {
      background: linear-gradient(90deg, var(--success), #2ecc71);
    }
    
    .stat-card i {
      font-size: 2.5rem;
      margin-bottom: 10px;
      display: block;
    }
    
    .stat-card.students i {
      color: var(--secondary);
    }
    
    .stat-card.teachers i {
      color: var(--accent);
    }
    
    .stat-card.assignments i {
      color: var(--warning);
    }
    
    .stat-card.books i {
      color: var(--success);
    }
    
    .stat-card h2 {
      font-size: 2.5rem;
      font-weight: 700;
      margin: 10px 0;
      color: var(--dark);
    }
    
    .stat-card small {
      font-size: 0.9rem;
      color: var(--gray);
      font-weight: 500;
    }
    
    .card {
      border: 1px solid rgba(189, 195, 199, 0.3);
      border-radius: 14px;
      box-shadow: 0 4px 15px rgba(44, 62, 80, 0.08);
      margin-bottom: 20px;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .card:hover {
      box-shadow: 0 8px 25px rgba(44, 62, 80, 0.12);
    }
    
    .card-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      font-weight: 600;
      padding: 18px 20px;
      border: none;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
      border: none;
      padding: 10px 25px;
      border-radius: 10px;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      color: white;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(52, 152, 219, 0.3);
      background: linear-gradient(135deg, var(--secondary-light) 0%, var(--secondary) 100%);
    }
    
    .btn-outline-primary {
      color: var(--secondary);
      border-color: var(--secondary);
    }
    
    .btn-outline-primary:hover {
      background: var(--secondary);
      border-color: var(--secondary);
    }
    
    .btn-light {
      background: var(--light);
      border-color: var(--gray-light);
      color: var(--dark);
    }
    
    .table {
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid rgba(189, 195, 199, 0.3);
    }
    
    .table thead {
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
      color: white;
    }
    
    .table th {
      font-weight: 600;
      border: none;
      padding: 15px;
    }
    
    .table td {
      padding: 12px 15px;
      vertical-align: middle;
      border-color: rgba(189, 195, 199, 0.2);
    }
    
    .table tbody tr {
      transition: background 0.2s ease;
    }
    
    .table tbody tr:hover {
      background: rgba(236, 240, 241, 0.5);
    }
    
    .badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.85rem;
    }
    
    .badge.bg-primary {
      background: var(--secondary) !important;
    }
    
    .badge.bg-info {
      background: var(--info) !important;
    }
    
    .badge.bg-success {
      background: var(--success) !important;
    }
    
    .badge.bg-warning {
      background: var(--warning) !important;
    }
    
    .badge.bg-secondary {
      background: var(--gray) !important;
    }
    
    .modal-content {
      border-radius: 16px;
      border: 1px solid rgba(189, 195, 199, 0.3);
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(44, 62, 80, 0.15);
    }
    
    .modal-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      border: none;
      padding: 20px;
    }
    
    .form-control, .form-select {
      border-radius: 10px;
      border: 2px solid var(--gray-light);
      padding: 12px 15px;
      transition: all 0.3s ease;
      font-size: 0.95rem;
    }
    
    .form-control:focus, .form-select:focus {
      border-color: var(--secondary);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    .btn-group-sm .btn {
      border-radius: 8px;
      margin: 0 2px;
      padding: 5px 10px;
    }
    
    .search-box {
      position: relative;
      margin-bottom: 20px;
    }
    
    .search-box input {
      padding-left: 45px;
      border-radius: 10px;
      border: 2px solid var(--gray-light);
    }
    
    .search-box i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
    }
    
    .academic-nav {
      background: white;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 3px 10px rgba(44, 62, 80, 0.05);
      border: 1px solid rgba(189, 195, 199, 0.2);
    }
    
    .academic-nav .list-group-item {
      border: 1px solid rgba(189, 195, 199, 0.3);
      border-radius: 8px;
      margin-bottom: 8px;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .academic-nav .list-group-item:hover {
      background: rgba(52, 152, 219, 0.08);
      color: var(--secondary);
      border-color: var(--secondary-light);
    }
    
    .academic-nav .list-group-item.active {
      background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
      color: white;
      border-color: var(--secondary);
    }
    
    .book-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(189, 195, 199, 0.2);
      box-shadow: 0 4px 12px rgba(44, 62, 80, 0.08);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .book-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(44, 62, 80, 0.12);
    }
    
    .audio-player {
      background: var(--light);
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
    }
    
    .audio-player audio {
      width: 100%;
      border-radius: 8px;
    }
    
    .book-cover {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 15px;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--gray);
    }
    
    .loading i {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--secondary);
    }
    
    .alert-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
      min-width: 300px;
      max-width: 400px;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(44, 62, 80, 0.15);
      border: none;
    }
    
    .alert-notification.show {
      opacity: 1;
      transform: translateX(0);
    }
    
    .alert-success {
      background: var(--success);
      color: white;
      border-left: 4px solid #27ae60;
    }
    
    .alert-danger {
      background: var(--danger);
      color: white;
      border-left: 4px solid #c0392b;
    }
    
    .alert-warning {
      background: var(--warning);
      color: white;
      border-left: 4px solid #e67e22;
    }
    
    .alert-info {
      background: var(--info);
      color: white;
      border-left: 4px solid #2980b9;
    }
    
    .btn-close-white {
      filter: invert(1) grayscale(100%) brightness(200%);
    }
    
    .text-muted {
      color: var(--gray) !important;
    }
    
    .btn-outline-danger {
      color: var(--danger);
      border-color: var(--danger);
    }
    
    .btn-outline-danger:hover {
      background: var(--danger);
      border-color: var(--danger);
    }
    
    .btn-outline-info {
      color: var(--info);
      border-color: var(--info);
    }
    
    .btn-outline-info:hover {
      background: var(--info);
      border-color: var(--info);
    }
    
    /* Personnalisation de la scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: var(--light);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--gray-light);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: var(--gray);
    }
    
    /* Effets de survol pour les boutons d'action */
    .btn-outline-primary, .btn-outline-info, .btn-outline-danger {
      transition: all 0.2s ease;
    }
    
    .btn-outline-primary:hover, .btn-outline-info:hover, .btn-outline-danger:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    /* Amélioration des ombres */
    .card, .sidebar, .main-container, .navbar, .book-card {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
    }
    
    /* Animation pour les icônes */
    .bi {
      transition: transform 0.2s ease;
    }
    
    .btn:hover .bi {
      transform: scale(1.1);
    }
    
    /* Style pour les badges dans les tableaux */
    .table .badge {
      font-size: 0.75rem;
      padding: 4px 10px;
    }
    
    /* Footer */
    .footer {
      background: var(--primary);
      color: white;
      padding: 40px 0 20px;
      margin-top: auto;
      border-top-left-radius: 16px;
      border-top-right-radius: 16px;
    }
    
    .footer h5 {
      color: white;
      margin-bottom: 20px;
      font-weight: 600;
    }
    
    .footer-links {
      list-style: none;
      padding: 0;
    }
    
    .footer-links li {
      margin-bottom: 10px;
    }
    
    .footer-links a {
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      transition: all 0.3s ease;
    }
    
    .footer-links a:hover {
      color: white;
      padding-left: 5px;
    }
    
    .social-icons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .social-icons a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }
    
    .social-icons a:hover {
      background: var(--secondary);
      transform: translateY(-3px);
    }
    
    .copyright {
      text-align: center;
      padding-top: 20px;
      margin-top: 30px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.9rem;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .main-container {
        padding: 20px;
        margin: 0 10px 15px 10px;
      }
      
      .navbar {
        margin: 0 10px 15px 10px;
        padding: 10px 15px;
      }
      
      .stat-card h2 {
        font-size: 2rem;
      }
      
      .footer {
        padding: 30px 15px 15px;
      }
      
      .footer .col-md-4 {
        margin-bottom: 30px;
      }

      body {
        font-size: 14px;
      }

      input, select, textarea, button {
        font-size: 15px;
      }
    }

    /* Téléphones petits (320px - 480px) */
    @media (max-width: 480px) {
      body {
        font-size: 13px;
        overflow-x: hidden;
      }

      .main-container {
        padding: 10px;
        margin: 0 5px 10px 5px;
      }

      .navbar {
        margin: 0 5px 10px 5px;
        padding: 8px 10px;
      }

      .navbar h1 {
        font-size: 1.2rem;
      }

      .navbar-nav {
        flex-direction: column;
        gap: 0.5rem;
      }

      .navbar-nav .nav-link {
        padding: 0.5rem;
        font-size: 0.9rem;
      }

      .stat-card {
        padding: 1rem;
        margin-bottom: 1rem;
        border-radius: 8px;
      }

      .stat-card h2 {
        font-size: 1.3rem;
      }

      .stat-card .stat-value {
        font-size: 1.2rem;
      }

      h1, h2 {
        font-size: 1.3rem;
      }

      h3, h4, h5, h6 {
        font-size: 1rem;
      }

      .form-label {
        font-size: 0.9rem;
        margin-bottom: 0.25rem;
      }

      input[type="text"],
      input[type="email"],
      input[type="tel"],
      input[type="date"],
      input[type="number"],
      select,
      textarea {
        font-size: 16px;
        padding: 0.75rem;
        width: 100%;
        border-radius: 6px;
      }

      button, .btn {
        padding: 0.75rem;
        font-size: 0.95rem;
        width: 100%;
        border-radius: 6px;
      }

      .d-flex {
        flex-direction: column;
        gap: 0.5rem;
      }

      .row {
        margin: 0;
        gap: 0;
      }

      [class*="col-"] {
        padding: 0.25rem;
        margin-bottom: 0.5rem;
      }

      .col-md-4 {
        width: 100%;
      }

      table {
        font-size: 0.75rem;
      }

      table th, table td {
        padding: 0.4rem;
      }

      .modal {
        padding: 0;
      }

      .modal-dialog {
        margin: 0.5rem;
        width: 95%;
      }

      .modal-content {
        border-radius: 10px;
      }

      .modal-body {
        padding: 1rem 0.75rem;
      }

      .modal-header, .modal-footer {
        padding: 0.75rem;
      }

      .alert-notification {
        max-width: 95%;
        right: 5px;
        left: 5px;
        font-size: 0.85rem;
        padding: 0.75rem;
        border-radius: 6px;
      }

      .footer {
        padding: 20px 10px 10px;
        font-size: 0.8rem;
      }

      .footer .col-md-4 {
        margin-bottom: 15px;
      }

      .footer h5 {
        font-size: 0.95rem;
      }

      .footer ul li {
        font-size: 0.8rem;
      }

      .navbar-brand {
        font-size: 1rem;
      }

      .card {
        border-radius: 8px;
        margin-bottom: 1rem;
      }

      .card-header {
        padding: 0.75rem;
        font-size: 0.95rem;
      }

      .card-body {
        padding: 0.75rem;
      }

      .badge {
        font-size: 0.7rem;
        padding: 0.3em 0.5em;
      }
    }

    /* Tablettes (481px - 768px) */
    @media (min-width: 481px) and (max-width: 768px) {
      body {
        font-size: 14px;
      }

      .main-container {
        padding: 15px;
        margin: 0 8px 12px 8px;
      }

      .navbar {
        margin: 0 8px 12px 8px;
        padding: 10px 15px;
      }

      .stat-card {
        padding: 1.25rem;
      }

      input, select, textarea, button {
        font-size: 14px;
      }

      table {
        font-size: 0.9rem;
      }
    }
  </style>
</head>
<body>
  <!-- Notification -->
  <div id="notification" class="alert-notification alert" role="alert" style="display: none;">
    <div class="d-flex justify-content-between align-items-start">
      <div>
        <strong id="notification-title"></strong>
        <div id="notification-message"></div>
      </div>
      <button type="button" class="btn-close btn-close-white" onclick="hideNotification()"></button>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
      <a class="navbar-brand" href="#">
        <i class="bi bi-mortarboard-fill me-2"></i>
        Eden Family School
      </a>
      <div class="d-flex align-items-center">
        <span class="me-3 text-muted">
          <i class="bi bi-person-circle me-1"></i>
          <span id="currentUser">Chargement...</span>
        </span>
        <button class="btn btn-outline-danger btn-sm" onclick="logout()">
          <i class="bi bi-box-arrow-right me-1"></i> Déconnexion
        </button>
      </div>
    </div>
  </nav>

  <div class="main-container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-lg-2 col-md-3 mb-4">
        <div class="sidebar">
          <div class="list-group">
            <a href="#students" class="list-group-item active" data-section="students" onclick="switchSection('students')">
              <i class="bi bi-people-fill me-2"></i> Élèves
            </a>
            <a href="#teachers" class="list-group-item" data-section="teachers" onclick="switchSection('teachers')">
              <i class="bi bi-person-badge-fill me-2"></i> Enseignants
            </a>
            <a href="#academic" class="list-group-item" data-section="academic" onclick="switchSection('academic')">
              <i class="bi bi-journal-text me-2"></i> Académique
            </a>
            <a href="#library" class="list-group-item" data-section="library" onclick="switchSection('library')">
              <i class="bi bi-book-fill me-2"></i> Bibliothèque
            </a>
          </div>
        </div>
        
        <!-- Statistiques -->
        <div class="mt-4">
          <div class="stat-card students" onclick="switchSection('students')">
            <i class="bi bi-people-fill"></i>
            <h2 id="statsStudents">0</h2>
            <small>Élèves actifs</small>
          </div>
          <div class="stat-card teachers" onclick="switchSection('teachers')">
            <i class="bi bi-person-badge-fill"></i>
            <h2 id="statsTeachers">0</h2>
            <small>Enseignants</small>
          </div>
          <div class="stat-card assignments" onclick="switchSection('academic')">
            <i class="bi bi-journal-text"></i>
            <h2 id="statsAssignments">0</h2>
            <small>Devoirs</small>
          </div>
          <div class="stat-card books" onclick="switchSection('library')">
            <i class="bi bi-book-fill"></i>
            <h2 id="statsBooks">0</h2>
            <small>Livres</small>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="col-lg-10 col-md-9">
        <!-- Section Élèves -->
        <div id="section-students" class="content-section fade-in">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0"><i class="bi bi-people-fill me-2"></i>Gestion des Élèves</h5>
              <button class="btn btn-light btn-sm" onclick="openAddStudentModal()">
                <i class="bi bi-plus-circle me-1"></i> Nouvel Élève
              </button>
            </div>
            <div class="card-body">
              <div class="search-box">
                <i class="bi bi-search"></i>
                <input type="text" class="form-control" id="searchStudent" placeholder="Rechercher un élève..." oninput="filterStudents()">
              </div>
              <div class="table-responsive">
                <table class="table table-hover align-middle">
                  <thead>
                    <tr>
                      <th><i class="bi bi-person me-1"></i>Nom Complet</th>
                      <th><i class="bi bi-building me-1"></i>Classe</th>
                      <th><i class="bi bi-gender-ambiguous me-1"></i>Sexe</th>
                      <th><i class="bi bi-people me-1"></i>Parent</th>
                      <th><i class="bi bi-telephone me-1"></i>Téléphone</th>
                      <th><i class="bi bi-calendar me-1"></i>Date Ajout</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="studentsTable">
                    <!-- Les élèves seront chargés ici -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Enseignants -->
        <div id="section-teachers" class="content-section" style="display: none;">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0"><i class="bi bi-person-badge-fill me-2"></i>Gestion des Enseignants</h5>
              <button class="btn btn-light btn-sm" onclick="openAddTeacherModal()">
                <i class="bi bi-plus-circle me-1"></i> Nouvel Enseignant
              </button>
            </div>
            <div class="card-body">
              <div class="search-box">
                <i class="bi bi-search"></i>
                <input type="text" class="form-control" id="searchTeacher" placeholder="Rechercher un enseignant..." oninput="filterTeachers()">
              </div>
              <div class="table-responsive">
                <table class="table table-hover align-middle">
                  <thead>
                    <tr>
                      <th><i class="bi bi-person me-1"></i>Nom</th>
                      <th><i class="bi bi-envelope me-1"></i>Email</th>
                      <th><i class="bi bi-telephone me-1"></i>Téléphone</th>
                      <th><i class="bi bi-book me-1"></i>Matière</th>
                      <th><i class="bi bi-check-circle me-1"></i>Statut</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="teachersTable">
                    <!-- Les enseignants seront chargés ici -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Académique -->
        <div id="section-academic" class="content-section" style="display: none;">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0"><i class="bi bi-journal-text me-2"></i>Gestion Académique</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-3">
                  <div class="academic-nav list-group">
                    <a href="#assignments" class="list-group-item active" onclick="switchAcademic('assignments')">
                      <i class="bi bi-clipboard-check me-2"></i>Devoirs
                    </a>
                    <a href="#tests" class="list-group-item" onclick="switchAcademic('tests')">
                      <i class="bi bi-file-text me-2"></i>Tests
                    </a>
                    <a href="#exams" class="list-group-item" onclick="switchAcademic('exams')">
                      <i class="bi bi-pen me-2"></i>Examens
                    </a>
                    <a href="#vacation" class="list-group-item" onclick="switchAcademic('vacation')">
                      <i class="bi bi-sun me-2"></i>Travaux Vacances
                    </a>
                  </div>
                </div>
                <div class="col-md-9">
                  <div id="academic-assignments" class="academic-content">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-clipboard-check me-2"></i>Gestion des Devoirs</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddAssignmentModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un devoir
                      </button>
                    </div>
                    <div id="assignmentsList"></div>
                  </div>
                  <div id="academic-tests" class="academic-content" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-file-text me-2"></i>Gestion des Tests</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddTestModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un test
                      </button>
                    </div>
                    <div id="testsList"></div>
                  </div>
                  <div id="academic-exams" class="academic-content" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-pen me-2"></i>Gestion des Examens</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddExamModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un examen
                      </button>
                    </div>
                    <div id="examsList"></div>
                  </div>
                  <div id="academic-vacation" class="academic-content" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-sun me-2"></i>Travaux de Vacances</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddVacationWorkModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un travail
                      </button>
                    </div>
                    <div id="vacationList"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Bibliothèque -->
        <div id="section-library" class="content-section" style="display: none;">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0"><i class="bi bi-book-fill me-2"></i>Bibliothèque en Ligne</h5>
              <div class="btn-group">
                <button class="btn btn-light btn-sm" onclick="openAddBookModal()">
                  <i class="bi bi-plus-circle me-1"></i> Ajouter un Livre
                </button>
                <button class="btn btn-light btn-sm" onclick="openAddAudioBookModal()">
                  <i class="bi bi-headphones me-1"></i> Ajouter un Livre Audio
                </button>
              </div>
            </div>
            <div class="card-body">
              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="search-box">
                    <i class="bi bi-search"></i>
                    <input type="text" class="form-control" id="searchBook" placeholder="Rechercher un livre..." oninput="filterBooks()">
                  </div>
                </div>
                <div class="col-md-6">
                  <select class="form-select" id="bookFilter" onchange="filterBooks()">
                    <option value="all">Tous les livres</option>
                    <option value="text">Livres texte</option>
                    <option value="audio">Livres audio</option>
                    <option value="available">Disponibles</option>
                  </select>
                </div>
              </div>
              
              <div class="row" id="libraryBooks">
                <!-- Les livres seront chargés ici -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-lg-4 col-md-6 mb-4">
          <h5>À propos d'Eden Family School</h5>
          <p>Notre école offre une éducation de qualité combinant excellence académique et développement personnel. Nous nous engageons à fournir un environnement d'apprentissage stimulant pour chaque élève.</p>
          <div class="social-icons">
            <a href="#"><i class="bi bi-facebook"></i></a>
            <a href="#"><i class="bi bi-twitter"></i></a>
            <a href="#"><i class="bi bi-instagram"></i></a>
            <a href="#"><i class="bi bi-youtube"></i></a>
          </div>
        </div>
        
        <div class="col-lg-4 col-md-6 mb-4">
          <h5>Liens Rapides</h5>
          <ul class="footer-links">
            <li><a href="#students"><i class="bi bi-chevron-right me-1"></i> Gestion des Élèves</a></li>
            <li><a href="#teachers"><i class="bi bi-chevron-right me-1"></i> Gestion des Enseignants</a></li>
            <li><a href="#academic"><i class="bi bi-chevron-right me-1"></i> Section Académique</a></li>
            <li><a href="#library"><i class="bi bi-chevron-right me-1"></i> Bibliothèque</a></li>
          </ul>
        </div>
        
        <div class="col-lg-4 col-md-6 mb-4">
          <h5>Contact & Aide</h5>
          <ul class="footer-links">
            <li><i class="bi bi-envelope me-2"></i> contact@edenfamilyschool.edu</li>
            <li><i class="bi bi-telephone me-2"></i> +33 1 23 45 67 89</li>
            <li><i class="bi bi-geo-alt me-2"></i> 123 Rue de l'Éducation, Paris</li>
            <li><a href="#"><i class="bi bi-question-circle me-1"></i> Centre d'Aide</a></li>
            <li><a href="#"><i class="bi bi-shield-check me-1"></i> Politique de Confidentialité</a></li>
            <li><a href="#"><i class="bi bi-file-text me-1"></i> Conditions d'Utilisation</a></li>
          </ul>
        </div>
      </div>
      
      <div class="copyright">
        <p>&copy; 2024 Eden Family School. Tous droits réservés.</p>
        <p>Portail Secrétaire - Version 2.0</p>
      </div>
    </div>
  </footer>

  <!-- Modal Ajouter/Éditer Élève -->
  <div class="modal fade" id="studentModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="studentModalTitle"><i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel Élève</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="studentForm">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-person me-1"></i>Nom Complet *</label>
                <input type="text" class="form-control" id="studentName" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-building me-1"></i>Classe *</label>
                <select class="form-select" id="studentClass" required>
                  <option value="">Sélectionner une classe</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-gender-ambiguous me-1"></i>Sexe *</label>
                <select class="form-select" id="studentGender" required>
                  <option value="">Sélectionner</option>
                  <option value="Masculin">Masculin</option>
                  <option value="Féminin">Féminin</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-calendar me-1"></i>Date de Naissance</label>
                <input type="date" class="form-control" id="studentDOB">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-people me-1"></i>Nom du Parent *</label>
                <input type="text" class="form-control" id="studentParent" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-telephone me-1"></i>Téléphone Parent *</label>
                <input type="tel" class="form-control" id="studentPhone" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-envelope me-1"></i>Email du Parent</label>
                <input type="email" class="form-control" id="studentEmail">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-check-circle me-1"></i>Statut *</label>
                <select class="form-select" id="studentStatus" required>
                  <option value="Actif">Actif</option>
                  <option value="Inactif">Inactif</option>
                  <option value="Suspendu">Suspendu</option>
                </select>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label"><i class="bi bi-geo-alt me-1"></i>Adresse</label>
                <textarea class="form-control" id="studentAddress" rows="2"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label"><i class="bi bi-chat-text me-1"></i>Remarques</label>
                <textarea class="form-control" id="studentNotes" rows="2"></textarea>
              </div>
            </div>
            <input type="hidden" id="studentId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/Éditer Enseignant -->
  <div class="modal fade" id="teacherModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="teacherModalTitle"><i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel Enseignant</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="teacherForm">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-person me-1"></i>Nom Complet *</label>
                <input type="text" class="form-control" id="teacherName" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-envelope me-1"></i>Email *</label>
                <input type="email" class="form-control" id="teacherEmail" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-telephone me-1"></i>Téléphone *</label>
                <input type="tel" class="form-control" id="teacherPhone" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-book me-1"></i>Matière Enseignée *</label>
                <input type="text" class="form-control" id="teacherSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-check-circle me-1"></i>Statut *</label>
                <select class="form-select" id="teacherStatus" required>
                  <option value="Actif">Actif</option>
                  <option value="Inactif">Inactif</option>
                  <option value="Congé">Congé</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-calendar me-1"></i>Date d'Embauche</label>
                <input type="date" class="form-control" id="teacherHireDate">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-building me-1"></i>Classes Enseignées</label>
                <input type="text" class="form-control" id="teacherClasses" placeholder="CP, CE1, CE2...">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-geo-alt me-1"></i>Adresse</label>
                <input type="text" class="form-control" id="teacherAddress">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label"><i class="bi bi-chat-text me-1"></i>Qualifications</label>
                <textarea class="form-control" id="teacherQualifications" rows="2"></textarea>
              </div>
            </div>
            <input type="hidden" id="teacherId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/Éditer Devoir -->
  <div class="modal fade" id="assignmentModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="assignmentModalTitle"><i class="bi bi-clipboard-plus me-2"></i>Ajouter un Devoir</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="assignmentForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="assignmentTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="assignmentClass" required>
                  <option value="">Sélectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Matière *</label>
                <input type="text" class="form-control" id="assignmentSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de Remise *</label>
                <input type="datetime-local" class="form-control" id="assignmentDueDate" required>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="assignmentDesc" rows="4"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Instructions</label>
                <textarea class="form-control" id="assignmentInstructions" rows="3"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Points Maximum</label>
                <input type="number" class="form-control" id="assignmentPoints" value="20" min="1" max="100">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="assignmentStatus">
                  <option value="Actif">Actif</option>
                  <option value="Terminé">Terminé</option>
                  <option value="Annulé">Annulé</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="assignmentId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/Éditer Test -->
  <div class="modal fade" id="testModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="testModalTitle"><i class="bi bi-file-plus me-2"></i>Ajouter un Test</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="testForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="testTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="testClass" required>
                  <option value="">Sélectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Matière *</label>
                <input type="text" class="form-control" id="testSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date du Test *</label>
                <input type="datetime-local" class="form-control" id="testDate" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Durée (minutes)</label>
                <input type="number" class="form-control" id="testDuration" value="60" min="15" max="180">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Note Maximale</label>
                <input type="number" class="form-control" id="testMaxScore" value="20" min="1" max="100">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="testDescription" rows="4"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Type de Test</label>
                <select class="form-select" id="testType">
                  <option value="Contrôle">Contrôle</option>
                  <option value="Interrogation">Interrogation</option>
                  <option value="Quiz">Quiz</option>
                  <option value="Oral">Oral</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="testStatus">
                  <option value="Planifié">Planifié</option>
                  <option value="Terminé">Terminé</option>
                  <option value="Annulé">Annulé</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="testId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/Éditer Examen -->
  <div class="modal fade" id="examModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="examModalTitle"><i class="bi bi-pen-plus me-2"></i>Ajouter un Examen</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="examForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="examTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="examClass" required>
                  <option value="">Sélectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Matière *</label>
                <input type="text" class="form-control" id="examSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de l'Examen *</label>
                <input type="datetime-local" class="form-control" id="examDate" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Durée (minutes)</label>
                <input type="number" class="form-control" id="examDuration" value="120" min="60" max="240">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Coefficient</label>
                <input type="number" class="form-control" id="examCoefficient" value="1" min="1" max="5" step="0.5">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="examDescription" rows="4"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Type d'Examen</label>
                <select class="form-select" id="examType">
                  <option value="Partiel">Partiel</option>
                  <option value="Final">Final</option>
                  <option value="Rattrapage">Rattrapage</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="examStatus">
                  <option value="Planifié">Planifié</option>
                  <option value="En cours">En cours</option>
                  <option value="Corrigé">Corrigé</option>
                  <option value="Terminé">Terminé</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="examId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/Éditer Travail de Vacances -->
  <div class="modal fade" id="vacationWorkModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="vacationWorkModalTitle"><i class="bi bi-sun-plus me-2"></i>Ajouter un Travail de Vacances</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="vacationWorkForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="vacationWorkTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="vacationWorkClass" required>
                  <option value="">Sélectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Matière *</label>
                <input type="text" class="form-control" id="vacationWorkSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Période</label>
                <input type="text" class="form-control" id="vacationWorkPeriod" placeholder="Ex: Vacances de Noël 2023" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de Début</label>
                <input type="date" class="form-control" id="vacationWorkStartDate">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de Fin</label>
                <input type="date" class="form-control" id="vacationWorkEndDate">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="vacationWorkDescription" rows="4"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Instructions</label>
                <textarea class="form-control" id="vacationWorkInstructions" rows="3"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Fichiers à Fournir (liens)</label>
                <textarea class="form-control" id="vacationWorkFiles" rows="2" placeholder="https://exemple.com/document.pdf"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="vacationWorkStatus">
                  <option value="Actif">Actif</option>
                  <option value="Terminé">Terminé</option>
                  <option value="Archivé">Archivé</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="vacationWorkId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/Éditer Livre Texte -->
  <div class="modal fade" id="bookModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="bookModalTitle"><i class="bi bi-book-fill me-2"></i>Ajouter un Livre</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="bookForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre du Livre *</label>
                <input type="text" class="form-control" id="bookTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Auteur *</label>
                <input type="text" class="form-control" id="bookAuthor" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Catégorie *</label>
                <select class="form-select" id="bookCategory" required>
                  <option value="">Sélectionner</option>
                  <option value="Fiction">Fiction</option>
                  <option value="Science">Science</option>
                  <option value="Histoire">Histoire</option>
                  <option value="Mathématiques">Mathématiques</option>
                  <option value="Littérature">Littérature</option>
                  <option value="Langues">Langues</option>
                  <option value="Arts">Arts</option>
                  <option value="Scolaire">Scolaire</option>
                  <option value="Autres">Autres</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Classe Cible</label>
                <select class="form-select" id="bookClass">
                  <option value="Toutes">Toutes les classes</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">ISBN</label>
                <input type="text" class="form-control" id="bookISBN">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Année de Publication</label>
                <input type="number" class="form-control" id="bookYear" min="1900" max="2024">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="bookDescription" rows="3"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">URL du Livre (PDF ou Lien en ligne) *</label>
                <input type="url" class="form-control" id="bookUrl" placeholder="https://exemple.com/livre.pdf" required>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Image de Couverture (URL)</label>
                <input type="url" class="form-control" id="bookCover" placeholder="https://exemple.com/couverture.jpg">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Langue</label>
                <select class="form-select" id="bookLanguage">
                  <option value="Français">Français</option>
                  <option value="Anglais">Anglais</option>
                  <option value="Espagnol">Espagnol</option>
                  <option value="Arabe">Arabe</option>
                  <option value="Autre">Autre</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="bookStatus">
                  <option value="Disponible">Disponible</option>
                  <option value="Indisponible">Indisponible</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="bookId">
            <input type="hidden" id="bookType" value="text">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer le Livre
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/Éditer Livre Audio -->
  <div class="modal fade" id="audioBookModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="audioBookModalTitle"><i class="bi bi-headphones me-2"></i>Ajouter un Livre Audio</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="audioBookForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre du Livre Audio *</label>
                <input type="text" class="form-control" id="audioBookTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Auteur/Narrateur *</label>
                <input type="text" class="form-control" id="audioBookAuthor" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Catégorie *</label>
                <select class="form-select" id="audioBookCategory" required>
                  <option value="">Sélectionner</option>
                  <option value="Fiction">Fiction</option>
                  <option value="Science">Science</option>
                  <option value="Histoire">Histoire</option>
                  <option value="Littérature">Littérature</option>
                  <option value="Jeunesse">Jeunesse</option>
                  <option value="Éducatif">Éducatif</option>
                  <option value="Autres">Autres</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Classe Cible</label>
                <select class="form-select" id="audioBookClass">
                  <option value="Toutes">Toutes les classes</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Durée (minutes)</label>
                <input type="number" class="form-control" id="audioBookDuration" min="1" max="600">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Année de Publication</label>
                <input type="number" class="form-control" id="audioBookYear" min="1900" max="2024">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="audioBookDescription" rows="3"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">URL du Fichier Audio *</label>
                <input type="url" class="form-control" id="audioBookUrl" placeholder="https://exemple.com/livre-audio.mp3" required>
                <small class="text-muted">Formats supportés: MP3, WAV, OGG</small>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Image de Couverture (URL)</label>
                <input type="url" class="form-control" id="audioBookCover" placeholder="https://exemple.com/couverture.jpg">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Langue</label>
                <select class="form-select" id="audioBookLanguage">
                  <option value="Français">Français</option>
                  <option value="Anglais">Anglais</option>
                  <option value="Espagnol">Espagnol</option>
                  <option value="Arabe">Arabe</option>
                  <option value="Autre">Autre</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="audioBookStatus">
                  <option value="Disponible">Disponible</option>
                  <option value="Indisponible">Indisponible</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="audioBookId">
            <input type="hidden" id="audioBookType" value="audio">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer le Livre Audio
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"></script>
  <script src="firebase-config.js"></script>

  <script>
    // Configuration Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCx6kmJ59x0tLt4vh_3czvEEQrtw4aWFHs",
      authDomain: "edendatabase-7e1ed.firebaseapp.com",
      databaseURL: "https://edendatabase-7e1ed-default-rtdb.firebaseio.com",
      projectId: "edendatabase-7e1ed",
      storageBucket: "edendatabase-7e1ed.firebasestorage.app",
      messagingSenderId: "147248399046",
      appId: "1:147248399046:web:d0b433e755772bbe718dc7",
      measurementId: "G-XB192PCMV7"
    };

    // Initialiser Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    // Variables globales
    let currentUser = null;
    let studentsData = [];
    let teachersData = [];
    let assignmentsData = [];
    let testsData = [];
    let examsData = [];
    let vacationWorksData = [];
    let booksData = [];
    let filteredStudents = [];
    let filteredTeachers = [];
    let filteredBooks = [];

    // Vérifier l'authentification
    auth.onAuthStateChanged((user) => {
      if (user) {
        currentUser = user;
        document.getElementById('currentUser').textContent = user.email || 'Secrétaire';
        loadAllData();
      } else {
        window.location.href = 'index.html';
      }
    });

    // Charger toutes les données
    function loadAllData() {
      loadStudents();
      loadTeachers();
      loadAssignments();
      loadTests();
      loadExams();
      loadVacationWorks();
      loadBooks();
    }

    // Charger les élèves
    function loadStudents() {
      const studentsRef = database.ref('students');
      studentsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        studentsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            studentsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        filteredStudents = [...studentsData];
        document.getElementById('statsStudents').textContent = studentsData.length;
        renderStudents();
      });
    }

    // Charger les enseignants
    function loadTeachers() {
      const teachersRef = database.ref('teachers');
      teachersRef.on('value', (snapshot) => {
        const data = snapshot.val();
        teachersData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            teachersData.push({
              id: key,
              ...data[key]
            });
          });
        }
        filteredTeachers = [...teachersData];
        document.getElementById('statsTeachers').textContent = teachersData.length;
        renderTeachers();
      });
    }

    // Charger les devoirs
    function loadAssignments() {
      const assignmentsRef = database.ref('assignments');
      assignmentsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        assignmentsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            assignmentsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        document.getElementById('statsAssignments').textContent = assignmentsData.length;
        renderAssignments();
      });
    }

    // Charger les tests
    function loadTests() {
      const testsRef = database.ref('tests');
      testsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        testsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            testsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        renderTests();
      });
    }

    // Charger les examens
    function loadExams() {
      const examsRef = database.ref('exams');
      examsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        examsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            examsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        renderExams();
      });
    }

    // Charger les travaux de vacances
    function loadVacationWorks() {
      const vacationWorksRef = database.ref('vacationWorks');
      vacationWorksRef.on('value', (snapshot) => {
        const data = snapshot.val();
        vacationWorksData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            vacationWorksData.push({
              id: key,
              ...data[key]
            });
          });
        }
        renderVacationWorks();
      });
    }

    // Charger les livres
    function loadBooks() {
      const booksRef = database.ref('books');
      booksRef.on('value', (snapshot) => {
        const data = snapshot.val();
        booksData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            booksData.push({
              id: key,
              ...data[key]
            });
          });
        }
        filteredBooks = [...booksData];
        document.getElementById('statsBooks').textContent = booksData.length;
        renderBooks();
      });
    }

    // Navigation entre sections
    function switchSection(section) {
      document.querySelectorAll('.content-section').forEach(s => {
        s.style.display = 'none';
        s.classList.remove('fade-in');
      });
      
      const targetSection = document.getElementById('section-' + section);
      targetSection.style.display = 'block';
      setTimeout(() => targetSection.classList.add('fade-in'), 10);
      
      document.querySelectorAll('.sidebar .list-group-item').forEach(item => {
        item.classList.remove('active');
      });
      
      document.querySelector(`.sidebar .list-group-item[data-section="${section}"]`).classList.add('active');
    }

    // Navigation académique
    function switchAcademic(type) {
      document.querySelectorAll('.academic-content').forEach(c => {
        c.style.display = 'none';
      });
      
      document.getElementById('academic-' + type).style.display = 'block';
      
      document.querySelectorAll('.academic-nav .list-group-item').forEach(item => {
        item.classList.remove('active');
      });
      
      event.target.classList.add('active');
    }

    // Afficher les élèves
    function renderStudents() {
      const tbody = document.getElementById('studentsTable');
      
      if (filteredStudents.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="text-center text-muted py-5">
              <i class="bi bi-inbox" style="font-size: 3rem; opacity: 0.3;"></i>
              <p class="mt-2">Aucun élève enregistré</p>
              <button class="btn btn-primary mt-2" onclick="openAddStudentModal()">
                <i class="bi bi-plus-circle me-1"></i> Ajouter un élève
              </button>
            </td>
          </tr>`;
        return;
      }
      
      let html = '';
      filteredStudents.forEach(student => {
        const dateAdded = student.dateAdded ? new Date(student.dateAdded).toLocaleDateString('fr-FR') : '-';
        const dob = student.dob ? new Date(student.dob).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <div class="me-2">
                  <i class="bi bi-person-circle" style="font-size: 1.5rem; color: ${student.gender === 'Féminin' ? '#e74c3c' : '#3498db'}"></i>
                </div>
                <div>
                  <strong>${student.name || ''}</strong>
                  ${student.dob ? `<br><small class="text-muted">Né le: ${dob}</small>` : ''}
                </div>
              </div>
            </td>
            <td><span class="badge bg-primary">${student.class || ''}</span></td>
            <td>${student.gender || ''}</td>
            <td>
              <div>
                <strong>${student.parent || ''}</strong>
                ${student.parentEmail ? `<br><small class="text-muted">${student.parentEmail}</small>` : ''}
              </div>
            </td>
            <td><i class="bi bi-telephone me-1"></i>${student.phone || ''}</td>
            <td><small>${dateAdded}</small></td>
            <td>
              <div class="btn-group btn-group-sm">
                <button class="btn btn-outline-info" onclick="viewStudent('${student.id}')" title="Voir">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-outline-primary" onclick="editStudent('${student.id}')" title="Modifier">
                  <i class="bi bi-pencil"></i>
                </button>
                <button class="btn btn-outline-danger" onclick="deleteStudent('${student.id}')" title="Supprimer">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }

    // Afficher les enseignants
    function renderTeachers() {
      const tbody = document.getElementById('teachersTable');
      
      if (filteredTeachers.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" class="text-center text-muted py-5">
              <i class="bi bi-inbox" style="font-size: 3rem; opacity: 0.3;"></i>
              <p class="mt-2">Aucun enseignant enregistré</p>
              <button class="btn btn-primary mt-2" onclick="openAddTeacherModal()">
                <i class="bi bi-plus-circle me-1"></i> Ajouter un enseignant
              </button>
            </td>
          </tr>`;
        return;
      }
      
      let html = '';
      filteredTeachers.forEach(teacher => {
        const status = teacher.status === 'Actif' ? 
          '<span class="badge bg-success"><i class="bi bi-check-circle me-1"></i>Actif</span>' : 
          teacher.status === 'Congé' ?
          '<span class="badge bg-warning"><i class="bi bi-clock me-1"></i>Congé</span>' :
          '<span class="badge bg-secondary"><i class="bi bi-x-circle me-1"></i>Inactif</span>';
        
        html += `
          <tr>
            <td><strong>${teacher.name || ''}</strong></td>
            <td><i class="bi bi-envelope me-1"></i>${teacher.email || ''}</td>
            <td><i class="bi bi-telephone me-1"></i>${teacher.phone || ''}</td>
            <td><span class="badge bg-info">${teacher.subject || ''}</span></td>
            <td>${status}</td>
            <td>
              <div class="btn-group btn-group-sm">
                <button class="btn btn-outline-info" onclick="viewTeacher('${teacher.id}')" title="Voir">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-outline-primary" onclick="editTeacher('${teacher.id}')" title="Modifier">
                  <i class="bi bi-pencil"></i>
                </button>
                <button class="btn btn-outline-danger" onclick="deleteTeacher('${teacher.id}')" title="Supprimer">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }

    // Afficher les devoirs
    function renderAssignments() {
      const container = document.getElementById('assignmentsList');
      
      if (assignmentsData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun devoir enregistré. Cliquez sur "Ajouter un devoir" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      assignmentsData.forEach(assignment => {
        const dueDate = assignment.dueDate ? new Date(assignment.dueDate).toLocaleString('fr-FR') : '-';
        const createdDate = assignment.dateAdded ? new Date(assignment.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${assignment.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${assignment.class || ''}</span>
                    <span class="badge bg-info">${assignment.subject || ''}</span>
                    ${assignment.points ? `<span class="badge bg-warning">${assignment.points} points</span>` : ''}
                  </p>
                  ${assignment.description ? `<p class="mb-2">${assignment.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Créé: ${createdDate}</small>
                    <small><i class="bi bi-clock me-1"></i>À rendre: ${dueDate}</small>
                    <small><i class="bi bi-flag me-1"></i>Statut: ${assignment.status || 'Actif'}</small>
                  </div>
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editAssignment('${assignment.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteAssignment('${assignment.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les tests
    function renderTests() {
      const container = document.getElementById('testsList');
      
      if (testsData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun test enregistré. Cliquez sur "Ajouter un test" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      testsData.forEach(test => {
        const testDate = test.date ? new Date(test.date).toLocaleString('fr-FR') : '-';
        const createdDate = test.dateAdded ? new Date(test.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${test.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${test.class || ''}</span>
                    <span class="badge bg-info">${test.subject || ''}</span>
                    <span class="badge bg-warning">${test.type || 'Contrôle'}</span>
                    ${test.maxScore ? `<span class="badge bg-success">${test.maxScore} points max</span>` : ''}
                  </p>
                  ${test.description ? `<p class="mb-2">${test.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Créé: ${createdDate}</small>
                    <small><i class="bi bi-clock me-1"></i>Date: ${testDate}</small>
                    ${test.duration ? `<small><i class="bi bi-hourglass me-1"></i>Durée: ${test.duration} min</small>` : ''}
                    <small><i class="bi bi-flag me-1"></i>Statut: ${test.status || 'Planifié'}</small>
                  </div>
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editTest('${test.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteTest('${test.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les examens
    function renderExams() {
      const container = document.getElementById('examsList');
      
      if (examsData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun examen enregistré. Cliquez sur "Ajouter un examen" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      examsData.forEach(exam => {
        const examDate = exam.date ? new Date(exam.date).toLocaleString('fr-FR') : '-';
        const createdDate = exam.dateAdded ? new Date(exam.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${exam.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${exam.class || ''}</span>
                    <span class="badge bg-info">${exam.subject || ''}</span>
                    <span class="badge bg-warning">${exam.type || 'Partiel'}</span>
                    ${exam.coefficient ? `<span class="badge bg-success">Coeff: ${exam.coefficient}</span>` : ''}
                  </p>
                  ${exam.description ? `<p class="mb-2">${exam.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Créé: ${createdDate}</small>
                    <small><i class="bi bi-clock me-1"></i>Date: ${examDate}</small>
                    ${exam.duration ? `<small><i class="bi bi-hourglass me-1"></i>Durée: ${exam.duration} min</small>` : ''}
                    <small><i class="bi bi-flag me-1"></i>Statut: ${exam.status || 'Planifié'}</small>
                  </div>
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editExam('${exam.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteExam('${exam.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les travaux de vacances
    function renderVacationWorks() {
      const container = document.getElementById('vacationList');
      
      if (vacationWorksData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun travail de vacances enregistré. Cliquez sur "Ajouter un travail" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      vacationWorksData.forEach(work => {
        const startDate = work.startDate ? new Date(work.startDate).toLocaleDateString('fr-FR') : '-';
        const endDate = work.endDate ? new Date(work.endDate).toLocaleDateString('fr-FR') : '-';
        const createdDate = work.dateAdded ? new Date(work.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${work.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${work.class || ''}</span>
                    <span class="badge bg-info">${work.subject || ''}</span>
                    <span class="badge bg-warning">${work.period || ''}</span>
                  </p>
                  ${work.description ? `<p class="mb-2">${work.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Créé: ${createdDate}</small>
                    <small><i class="bi bi-calendar-plus me-1"></i>Début: ${startDate}</small>
                    <small><i class="bi bi-calendar-check me-1"></i>Fin: ${endDate}</small>
                    <small><i class="bi bi-flag me-1"></i>Statut: ${work.status || 'Actif'}</small>
                  </div>
                  ${work.files ? `<small class="d-block mt-2"><i class="bi bi-paperclip me-1"></i>Fichiers: ${work.files}</small>` : ''}
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editVacationWork('${work.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteVacationWork('${work.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les livres
    function renderBooks() {
      const container = document.getElementById('libraryBooks');
      
      if (filteredBooks.length === 0) {
        container.innerHTML = `
          <div class="col-12 text-center text-muted py-5">
            <i class="bi bi-book" style="font-size: 3rem; opacity: 0.3;"></i>
            <p class="mt-2">Aucun livre dans la bibliothèque</p>
            <div class="mt-3">
              <button class="btn btn-primary me-2" onclick="openAddBookModal()">
                <i class="bi bi-plus-circle me-1"></i> Ajouter un livre
              </button>
              <button class="btn btn-secondary" onclick="openAddAudioBookModal()">
                <i class="bi bi-headphones me-1"></i> Ajouter un livre audio
              </button>
            </div>
          </div>`;
        return;
      }
      
      let html = '';
      filteredBooks.forEach(book => {
        const isAudioBook = book.type === 'audio';
        const coverImage = book.cover || (isAudioBook ? 'https://images.unsplash.com/photo-1532012197267-da84d127e765?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80' : 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80');
        
        html += `
          <div class="col-md-4 col-lg-3">
            <div class="book-card">
              <img src="${coverImage}" alt="${book.title}" class="book-cover">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h6 class="mb-0">${book.title || ''}</h6>
                <span class="badge ${isAudioBook ? 'bg-info' : 'bg-primary'}">
                  ${isAudioBook ? '<i class="bi bi-headphones me-1"></i>Audio' : '<i class="bi bi-book me-1"></i>Texte'}
                </span>
              </div>
              <p class="text-muted mb-2"><small>Par ${book.author || 'Inconnu'}</small></p>
              ${book.year ? `<p class="mb-1"><small><i class="bi bi-calendar me-1"></i>${book.year}</small></p>` : ''}
              <span class="badge bg-secondary mb-2">${book.category || 'Autre'}</span>
              
              ${isAudioBook ? `
                <div class="audio-player">
                  <audio controls>
                    <source src="${book.url || ''}" type="audio/mpeg">
                    Votre navigateur ne supporte pas l'élément audio.
                  </audio>
                  ${book.duration ? `<small class="d-block mt-2 text-center"><i class="bi bi-clock me-1"></i>${book.duration} min</small>` : ''}
                </div>
              ` : `
                <p class="mb-2"><small>${book.description ? book.description.substring(0, 80) + '...' : 'Pas de description'}</small></p>
              `}
              
              <div class="d-flex justify-content-between align-items-center">
                <p class="mb-0"><small><i class="bi bi-people me-1"></i>${book.class || 'Toutes classes'}</small></p>
                <div class="btn-group btn-group-sm">
                  ${isAudioBook ? `
                    <button class="btn btn-outline-info" onclick="playAudioBook('${book.id}')" title="Écouter">
                      <i class="bi bi-play-fill"></i>
                    </button>
                  ` : `
                    <a href="${book.url || '#'}" target="_blank" class="btn btn-outline-info" title="Lire">
                      <i class="bi bi-eye"></i>
                    </a>
                  `}
                  <button class="btn btn-outline-primary" onclick="${isAudioBook ? 'editAudioBook' : 'editBook'}('${book.id}')" title="Modifier">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteBook('${book.id}')" title="Supprimer">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Filtrer les élèves
    function filterStudents() {
      const searchTerm = document.getElementById('searchStudent').value.toLowerCase();
      
      filteredStudents = studentsData.filter(student => {
        return (
          (student.name && student.name.toLowerCase().includes(searchTerm)) ||
          (student.class && student.class.toLowerCase().includes(searchTerm)) ||
          (student.parent && student.parent.toLowerCase().includes(searchTerm)) ||
          (student.phone && student.phone.includes(searchTerm))
        );
      });
      
      renderStudents();
    }

    // Filtrer les enseignants
    function filterTeachers() {
      const searchTerm = document.getElementById('searchTeacher').value.toLowerCase();
      
      filteredTeachers = teachersData.filter(teacher => {
        return (
          (teacher.name && teacher.name.toLowerCase().includes(searchTerm)) ||
          (teacher.email && teacher.email.toLowerCase().includes(searchTerm)) ||
          (teacher.subject && teacher.subject.toLowerCase().includes(searchTerm)) ||
          (teacher.phone && teacher.phone.includes(searchTerm))
        );
      });
      
      renderTeachers();
    }

    // Filtrer les livres
    function filterBooks() {
      const searchTerm = document.getElementById('searchBook').value.toLowerCase();
      const filterType = document.getElementById('bookFilter').value;
      
      filteredBooks = booksData.filter(book => {
        const matchesSearch = (
          (book.title && book.title.toLowerCase().includes(searchTerm)) ||
          (book.author && book.author.toLowerCase().includes(searchTerm)) ||
          (book.category && book.category.toLowerCase().includes(searchTerm)) ||
          (book.description && book.description.toLowerCase().includes(searchTerm))
        );
        
        if (!matchesSearch) return false;
        
        if (filterType === 'text') return book.type === 'text';
        if (filterType === 'audio') return book.type === 'audio';
        if (filterType === 'available') return book.status === 'Disponible';
        
        return true; // 'all'
      });
      
      renderBooks();
    }

    // Modal Élève
    function openAddStudentModal() {
      document.getElementById('studentModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel Élève';
      document.getElementById('studentForm').reset();
      document.getElementById('studentId').value = '';
      document.getElementById('studentStatus').value = 'Actif';
      
      const modal = new bootstrap.Modal(document.getElementById('studentModal'));
      modal.show();
    }

    function editStudent(id) {
      const student = studentsData.find(s => s.id === id);
      if (!student) return;
      
      document.getElementById('studentModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Modifier l\'Élève';
      document.getElementById('studentId').value = student.id;
      document.getElementById('studentName').value = student.name || '';
      document.getElementById('studentClass').value = student.class || '';
      document.getElementById('studentGender').value = student.gender || '';
      document.getElementById('studentDOB').value = student.dob || '';
      document.getElementById('studentParent').value = student.parent || '';
      document.getElementById('studentPhone').value = student.phone || '';
      document.getElementById('studentEmail').value = student.parentEmail || '';
      document.getElementById('studentStatus').value = student.status || 'Actif';
      document.getElementById('studentAddress').value = student.address || '';
      document.getElementById('studentNotes').value = student.notes || '';
      
      const modal = new bootstrap.Modal(document.getElementById('studentModal'));
      modal.show();
    }

    document.getElementById('studentForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const studentId = document.getElementById('studentId').value;
      const studentData = {
        name: document.getElementById('studentName').value,
        class: document.getElementById('studentClass').value,
        gender: document.getElementById('studentGender').value,
        dob: document.getElementById('studentDOB').value,
        parent: document.getElementById('studentParent').value,
        phone: document.getElementById('studentPhone').value,
        parentEmail: document.getElementById('studentEmail').value,
        status: document.getElementById('studentStatus').value,
        address: document.getElementById('studentAddress').value,
        notes: document.getElementById('studentNotes').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!studentId) {
        studentData.dateAdded = new Date().toISOString();
        studentData.createdBy = currentUser.email;
      }
      
      let promise;
      if (studentId) {
        promise = database.ref('students/' + studentId).update(studentData);
      } else {
        promise = database.ref('students').push(studentData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('studentModal')).hide();
        showNotification(
          studentId ? 'Élève modifié avec succès!' : 'Élève ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteStudent(id) {
      if (confirm('Êtes-vous sûr de vouloir supprimer cet élève ? Cette action est irréversible.')) {
        database.ref('students/' + id).remove()
          .then(() => {
            showNotification('Élève supprimé avec succès!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Enseignant
    function openAddTeacherModal() {
      document.getElementById('teacherModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel Enseignant';
      document.getElementById('teacherForm').reset();
      document.getElementById('teacherId').value = '';
      document.getElementById('teacherStatus').value = 'Actif';
      
      const modal = new bootstrap.Modal(document.getElementById('teacherModal'));
      modal.show();
    }

    function editTeacher(id) {
      const teacher = teachersData.find(t => t.id === id);
      if (!teacher) return;
      
      document.getElementById('teacherModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Modifier l\'Enseignant';
      document.getElementById('teacherId').value = teacher.id;
      document.getElementById('teacherName').value = teacher.name || '';
      document.getElementById('teacherEmail').value = teacher.email || '';
      document.getElementById('teacherPhone').value = teacher.phone || '';
      document.getElementById('teacherSubject').value = teacher.subject || '';
      document.getElementById('teacherStatus').value = teacher.status || 'Actif';
      document.getElementById('teacherHireDate').value = teacher.hireDate || '';
      document.getElementById('teacherClasses').value = teacher.classes || '';
      document.getElementById('teacherAddress').value = teacher.address || '';
      document.getElementById('teacherQualifications').value = teacher.qualifications || '';
      
      const modal = new bootstrap.Modal(document.getElementById('teacherModal'));
      modal.show();
    }

    document.getElementById('teacherForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const teacherId = document.getElementById('teacherId').value;
      const teacherData = {
        name: document.getElementById('teacherName').value,
        email: document.getElementById('teacherEmail').value,
        phone: document.getElementById('teacherPhone').value,
        subject: document.getElementById('teacherSubject').value,
        status: document.getElementById('teacherStatus').value,
        hireDate: document.getElementById('teacherHireDate').value,
        classes: document.getElementById('teacherClasses').value,
        address: document.getElementById('teacherAddress').value,
        qualifications: document.getElementById('teacherQualifications').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!teacherId) {
        teacherData.dateAdded = new Date().toISOString();
        teacherData.createdBy = currentUser.email;
      }
      
      let promise;
      if (teacherId) {
        promise = database.ref('teachers/' + teacherId).update(teacherData);
      } else {
        promise = database.ref('teachers').push(teacherData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('teacherModal')).hide();
        showNotification(
          teacherId ? 'Enseignant modifié avec succès!' : 'Enseignant ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteTeacher(id) {
      if (confirm('Êtes-vous sûr de vouloir supprimer cet enseignant ?')) {
        database.ref('teachers/' + id).remove()
          .then(() => {
            showNotification('Enseignant supprimé avec succès!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Devoir
    function openAddAssignmentModal() {
      document.getElementById('assignmentModalTitle').innerHTML = '<i class="bi bi-clipboard-plus me-2"></i>Ajouter un Devoir';
      document.getElementById('assignmentForm').reset();
      document.getElementById('assignmentId').value = '';
      document.getElementById('assignmentStatus').value = 'Actif';
      document.getElementById('assignmentPoints').value = 20;
      
      const now = new Date();
      const tomorrow = new Date(now);
      tomorrow.setDate(tomorrow.getDate() + 1);
      tomorrow.setHours(17, 0, 0);
      
      document.getElementById('assignmentDueDate').value = tomorrow.toISOString().slice(0, 16);
      
      const modal = new bootstrap.Modal(document.getElementById('assignmentModal'));
      modal.show();
    }

    function editAssignment(id) {
      const assignment = assignmentsData.find(a => a.id === id);
      if (!assignment) return;
      
      document.getElementById('assignmentModalTitle').innerHTML = '<i class="bi bi-clipboard-plus me-2"></i>Modifier le Devoir';
      document.getElementById('assignmentId').value = assignment.id;
      document.getElementById('assignmentTitle').value = assignment.title || '';
      document.getElementById('assignmentClass').value = assignment.class || '';
      document.getElementById('assignmentSubject').value = assignment.subject || '';
      document.getElementById('assignmentDesc').value = assignment.description || '';
      document.getElementById('assignmentInstructions').value = assignment.instructions || '';
      document.getElementById('assignmentPoints').value = assignment.points || 20;
      document.getElementById('assignmentStatus').value = assignment.status || 'Actif';
      
      if (assignment.dueDate) {
        const dueDate = new Date(assignment.dueDate);
        document.getElementById('assignmentDueDate').value = dueDate.toISOString().slice(0, 16);
      }
      
      const modal = new bootstrap.Modal(document.getElementById('assignmentModal'));
      modal.show();
    }

    document.getElementById('assignmentForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const assignmentId = document.getElementById('assignmentId').value;
      const assignmentData = {
        title: document.getElementById('assignmentTitle').value,
        class: document.getElementById('assignmentClass').value,
        subject: document.getElementById('assignmentSubject').value,
        description: document.getElementById('assignmentDesc').value,
        instructions: document.getElementById('assignmentInstructions').value,
        dueDate: document.getElementById('assignmentDueDate').value,
        points: document.getElementById('assignmentPoints').value,
        status: document.getElementById('assignmentStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!assignmentId) {
        assignmentData.dateAdded = new Date().toISOString();
        assignmentData.createdBy = currentUser.email;
      }
      
      let promise;
      if (assignmentId) {
        promise = database.ref('assignments/' + assignmentId).update(assignmentData);
      } else {
        promise = database.ref('assignments').push(assignmentData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('assignmentModal')).hide();
        showNotification(
          assignmentId ? 'Devoir modifié avec succès!' : 'Devoir ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteAssignment(id) {
      if (confirm('Êtes-vous sûr de vouloir supprimer ce devoir ?')) {
        database.ref('assignments/' + id).remove()
          .then(() => {
            showNotification('Devoir supprimé avec succès!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Test
    function openAddTestModal() {
      document.getElementById('testModalTitle').innerHTML = '<i class="bi bi-file-plus me-2"></i>Ajouter un Test';
      document.getElementById('testForm').reset();
      document.getElementById('testId').value = '';
      document.getElementById('testStatus').value = 'Planifié';
      document.getElementById('testDuration').value = 60;
      document.getElementById('testMaxScore').value = 20;
      document.getElementById('testType').value = 'Contrôle';
      
      const now = new Date();
      const nextWeek = new Date(now);
      nextWeek.setDate(nextWeek.getDate() + 7);
      nextWeek.setHours(9, 0, 0);
      
      document.getElementById('testDate').value = nextWeek.toISOString().slice(0, 16);
      
      const modal = new bootstrap.Modal(document.getElementById('testModal'));
      modal.show();
    }

    function editTest(id) {
      const test = testsData.find(t => t.id === id);
      if (!test) return;
      
      document.getElementById('testModalTitle').innerHTML = '<i class="bi bi-file-plus me-2"></i>Modifier le Test';
      document.getElementById('testId').value = test.id;
      document.getElementById('testTitle').value = test.title || '';
      document.getElementById('testClass').value = test.class || '';
      document.getElementById('testSubject').value = test.subject || '';
      document.getElementById('testDescription').value = test.description || '';
      document.getElementById('testDuration').value = test.duration || 60;
      document.getElementById('testMaxScore').value = test.maxScore || 20;
      document.getElementById('testType').value = test.type || 'Contrôle';
      document.getElementById('testStatus').value = test.status || 'Planifié';
      
      if (test.date) {
        const testDate = new Date(test.date);
        document.getElementById('testDate').value = testDate.toISOString().slice(0, 16);
      }
      
      const modal = new bootstrap.Modal(document.getElementById('testModal'));
      modal.show();
    }

    document.getElementById('testForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const testId = document.getElementById('testId').value;
      const testData = {
        title: document.getElementById('testTitle').value,
        class: document.getElementById('testClass').value,
        subject: document.getElementById('testSubject').value,
        description: document.getElementById('testDescription').value,
        date: document.getElementById('testDate').value,
        duration: document.getElementById('testDuration').value,
        maxScore: document.getElementById('testMaxScore').value,
        type: document.getElementById('testType').value,
        status: document.getElementById('testStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!testId) {
        testData.dateAdded = new Date().toISOString();
        testData.createdBy = currentUser.email;
      }
      
      let promise;
      if (testId) {
        promise = database.ref('tests/' + testId).update(testData);
      } else {
        promise = database.ref('tests').push(testData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('testModal')).hide();
        showNotification(
          testId ? 'Test modifié avec succès!' : 'Test ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteTest(id) {
      if (confirm('Êtes-vous sûr de vouloir supprimer ce test ?')) {
        database.ref('tests/' + id).remove()
          .then(() => {
            showNotification('Test supprimé avec succès!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Examen
    function openAddExamModal() {
      document.getElementById('examModalTitle').innerHTML = '<i class="bi bi-pen-plus me-2"></i>Ajouter un Examen';
      document.getElementById('examForm').reset();
      document.getElementById('examId').value = '';
      document.getElementById('examStatus').value = 'Planifié';
      document.getElementById('examDuration').value = 120;
      document.getElementById('examCoefficient').value = 1;
      document.getElementById('examType').value = 'Partiel';
      
      const now = new Date();
      const twoWeeks = new Date(now);
      twoWeeks.setDate(twoWeeks.getDate() + 14);
      twoWeeks.setHours(9, 0, 0);
      
      document.getElementById('examDate').value = twoWeeks.toISOString().slice(0, 16);
      
      const modal = new bootstrap.Modal(document.getElementById('examModal'));
      modal.show();
    }

    function editExam(id) {
      const exam = examsData.find(e => e.id === id);
      if (!exam) return;
      
      document.getElementById('examModalTitle').innerHTML = '<i class="bi bi-pen-plus me-2"></i>Modifier l\'Examen';
      document.getElementById('examId').value = exam.id;
      document.getElementById('examTitle').value = exam.title || '';
      document.getElementById('examClass').value = exam.class || '';
      document.getElementById('examSubject').value = exam.subject || '';
      document.getElementById('examDescription').value = exam.description || '';
      document.getElementById('examDuration').value = exam.duration || 120;
      document.getElementById('examCoefficient').value = exam.coefficient || 1;
      document.getElementById('examType').value = exam.type || 'Partiel';
      document.getElementById('examStatus').value = exam.status || 'Planifié';
      
      if (exam.date) {
        const examDate = new Date(exam.date);
        document.getElementById('examDate').value = examDate.toISOString().slice(0, 16);
      }
      
      const modal = new bootstrap.Modal(document.getElementById('examModal'));
      modal.show();
    }

    document.getElementById('examForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const examId = document.getElementById('examId').value;
      const examData = {
        title: document.getElementById('examTitle').value,
        class: document.getElementById('examClass').value,
        subject: document.getElementById('examSubject').value,
        description: document.getElementById('examDescription').value,
        date: document.getElementById('examDate').value,
        duration: document.getElementById('examDuration').value,
        coefficient: document.getElementById('examCoefficient').value,
        type: document.getElementById('examType').value,
        status: document.getElementById('examStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!examId) {
        examData.dateAdded = new Date().toISOString();
        examData.createdBy = currentUser.email;
      }
      
      let promise;
      if (examId) {
        promise = database.ref('exams/' + examId).update(examData);
      } else {
        promise = database.ref('exams').push(examData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('examModal')).hide();
        showNotification(
          examId ? 'Examen modifié avec succès!' : 'Examen ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteExam(id) {
      if (confirm('Êtes-vous sûr de vouloir supprimer cet examen ?')) {
        database.ref('exams/' + id).remove()
          .then(() => {
            showNotification('Examen supprimé avec succès!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Travail de Vacances
    function openAddVacationWorkModal() {
      document.getElementById('vacationWorkModalTitle').innerHTML = '<i class="bi bi-sun-plus me-2"></i>Ajouter un Travail de Vacances';
      document.getElementById('vacationWorkForm').reset();
      document.getElementById('vacationWorkId').value = '';
      document.getElementById('vacationWorkStatus').value = 'Actif';
      document.getElementById('vacationWorkPeriod').value = 'Vacances de Noël 2023';
      
      const now = new Date();
      const startDate = new Date(now);
      startDate.setDate(startDate.getDate() + 1);
      const endDate = new Date(now);
      endDate.setDate(endDate.getDate() + 15);
      
      document.getElementById('vacationWorkStartDate').value = startDate.toISOString().slice(0, 10);
      document.getElementById('vacationWorkEndDate').value = endDate.toISOString().slice(0, 10);
      
      const modal = new bootstrap.Modal(document.getElementById('vacationWorkModal'));
      modal.show();
    }

    function editVacationWork(id) {
      const work = vacationWorksData.find(w => w.id === id);
      if (!work) return;
      
      document.getElementById('vacationWorkModalTitle').innerHTML = '<i class="bi bi-sun-plus me-2"></i>Modifier le Travail de Vacances';
      document.getElementById('vacationWorkId').value = work.id;
      document.getElementById('vacationWorkTitle').value = work.title || '';
      document.getElementById('vacationWorkClass').value = work.class || '';
      document.getElementById('vacationWorkSubject').value = work.subject || '';
      document.getElementById('vacationWorkPeriod').value = work.period || '';
      document.getElementById('vacationWorkDescription').value = work.description || '';
      document.getElementById('vacationWorkInstructions').value = work.instructions || '';
      document.getElementById('vacationWorkFiles').value = work.files || '';
      document.getElementById('vacationWorkStatus').value = work.status || 'Actif';
      document.getElementById('vacationWorkStartDate').value = work.startDate || '';
      document.getElementById('vacationWorkEndDate').value = work.endDate || '';
      
      const modal = new bootstrap.Modal(document.getElementById('vacationWorkModal'));
      modal.show();
    }

    document.getElementById('vacationWorkForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const vacationWorkId = document.getElementById('vacationWorkId').value;
      const vacationWorkData = {
        title: document.getElementById('vacationWorkTitle').value,
        class: document.getElementById('vacationWorkClass').value,
        subject: document.getElementById('vacationWorkSubject').value,
        period: document.getElementById('vacationWorkPeriod').value,
        description: document.getElementById('vacationWorkDescription').value,
        instructions: document.getElementById('vacationWorkInstructions').value,
        files: document.getElementById('vacationWorkFiles').value,
        startDate: document.getElementById('vacationWorkStartDate').value,
        endDate: document.getElementById('vacationWorkEndDate').value,
        status: document.getElementById('vacationWorkStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!vacationWorkId) {
        vacationWorkData.dateAdded = new Date().toISOString();
        vacationWorkData.createdBy = currentUser.email;
      }
      
      let promise;
      if (vacationWorkId) {
        promise = database.ref('vacationWorks/' + vacationWorkId).update(vacationWorkData);
      } else {
        promise = database.ref('vacationWorks').push(vacationWorkData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('vacationWorkModal')).hide();
        showNotification(
          vacationWorkId ? 'Travail de vacances modifié avec succès!' : 'Travail de vacances ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteVacationWork(id) {
      if (confirm('Êtes-vous sûr de vouloir supprimer ce travail de vacances ?')) {
        database.ref('vacationWorks/' + id).remove()
          .then(() => {
            showNotification('Travail de vacances supprimé avec succès!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Livre Texte
    function openAddBookModal() {
      document.getElementById('bookModalTitle').innerHTML = '<i class="bi bi-book-fill me-2"></i>Ajouter un Livre';
      document.getElementById('bookForm').reset();
      document.getElementById('bookId').value = '';
      document.getElementById('bookStatus').value = 'Disponible';
      document.getElementById('bookLanguage').value = 'Français';
      document.getElementById('bookYear').value = new Date().getFullYear();
      document.getElementById('bookClass').value = 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('bookModal'));
      modal.show();
    }

    function editBook(id) {
      const book = booksData.find(b => b.id === id);
      if (!book) return;
      
      document.getElementById('bookModalTitle').innerHTML = '<i class="bi bi-book-fill me-2"></i>Modifier le Livre';
      document.getElementById('bookId').value = book.id;
      document.getElementById('bookTitle').value = book.title || '';
      document.getElementById('bookAuthor').value = book.author || '';
      document.getElementById('bookCategory').value = book.category || '';
      document.getElementById('bookISBN').value = book.isbn || '';
      document.getElementById('bookYear').value = book.year || '';
      document.getElementById('bookDescription').value = book.description || '';
      document.getElementById('bookUrl').value = book.url || '';
      document.getElementById('bookCover').value = book.cover || '';
      document.getElementById('bookLanguage').value = book.language || 'Français';
      document.getElementById('bookStatus').value = book.status || 'Disponible';
      document.getElementById('bookClass').value = book.class || 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('bookModal'));
      modal.show();
    }

    document.getElementById('bookForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const bookId = document.getElementById('bookId').value;
      const bookData = {
        title: document.getElementById('bookTitle').value,
        author: document.getElementById('bookAuthor').value,
        category: document.getElementById('bookCategory').value,
        isbn: document.getElementById('bookISBN').value,
        year: document.getElementById('bookYear').value,
        description: document.getElementById('bookDescription').value,
        url: document.getElementById('bookUrl').value,
        cover: document.getElementById('bookCover').value,
        language: document.getElementById('bookLanguage').value,
        status: document.getElementById('bookStatus').value,
        class: document.getElementById('bookClass').value,
        type: 'text',
        updatedAt: new Date().toISOString()
      };
      
      if (!bookId) {
        bookData.dateAdded = new Date().toISOString();
        bookData.createdBy = currentUser.email;
      }
      
      let promise;
      if (bookId) {
        promise = database.ref('books/' + bookId).update(bookData);
      } else {
        promise = database.ref('books').push(bookData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('bookModal')).hide();
        showNotification(
          bookId ? 'Livre modifié avec succès!' : 'Livre ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    // Modal Livre Audio
    function openAddAudioBookModal() {
      document.getElementById('audioBookModalTitle').innerHTML = '<i class="bi bi-headphones me-2"></i>Ajouter un Livre Audio';
      document.getElementById('audioBookForm').reset();
      document.getElementById('audioBookId').value = '';
      document.getElementById('audioBookStatus').value = 'Disponible';
      document.getElementById('audioBookLanguage').value = 'Français';
      document.getElementById('audioBookYear').value = new Date().getFullYear();
      document.getElementById('audioBookClass').value = 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('audioBookModal'));
      modal.show();
    }

    function editAudioBook(id) {
      const book = booksData.find(b => b.id === id);
      if (!book) return;
      
      document.getElementById('audioBookModalTitle').innerHTML = '<i class="bi bi-headphones me-2"></i>Modifier le Livre Audio';
      document.getElementById('audioBookId').value = book.id;
      document.getElementById('audioBookTitle').value = book.title || '';
      document.getElementById('audioBookAuthor').value = book.author || '';
      document.getElementById('audioBookCategory').value = book.category || '';
      document.getElementById('audioBookDuration').value = book.duration || '';
      document.getElementById('audioBookYear').value = book.year || '';
      document.getElementById('audioBookDescription').value = book.description || '';
      document.getElementById('audioBookUrl').value = book.url || '';
      document.getElementById('audioBookCover').value = book.cover || '';
      document.getElementById('audioBookLanguage').value = book.language || 'Français';
      document.getElementById('audioBookStatus').value = book.status || 'Disponible';
      document.getElementById('audioBookClass').value = book.class || 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('audioBookModal'));
      modal.show();
    }

    document.getElementById('audioBookForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const audioBookId = document.getElementById('audioBookId').value;
      const audioBookData = {
        title: document.getElementById('audioBookTitle').value,
        author: document.getElementById('audioBookAuthor').value,
        category: document.getElementById('audioBookCategory').value,
        duration: document.getElementById('audioBookDuration').value,
        year: document.getElementById('audioBookYear').value,
        description: document.getElementById('audioBookDescription').value,
        url: document.getElementById('audioBookUrl').value,
        cover: document.getElementById('audioBookCover').value,
        language: document.getElementById('audioBookLanguage').value,
        status: document.getElementById('audioBookStatus').value,
        class: document.getElementById('audioBookClass').value,
        type: 'audio',
        updatedAt: new Date().toISOString()
      };
      
      if (!audioBookId) {
        audioBookData.dateAdded = new Date().toISOString();
        audioBookData.createdBy = currentUser.email;
      }
      
      let promise;
      if (audioBookId) {
        promise = database.ref('books/' + audioBookId).update(audioBookData);
      } else {
        promise = database.ref('books').push(audioBookData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('audioBookModal')).hide();
        showNotification(
          audioBookId ? 'Livre audio modifié avec succès!' : 'Livre audio ajouté avec succès!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteBook(id) {
      if (confirm('Êtes-vous sûr de vouloir supprimer ce livre ?')) {
        database.ref('books/' + id).remove()
          .then(() => {
            showNotification('Livre supprimé avec succès!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Fonction pour jouer un livre audio
    function playAudioBook(id) {
      const book = booksData.find(b => b.id === id);
      if (!book || !book.url) return;
      
      // Ouvrir le lecteur audio dans une nouvelle fenêtre
      window.open(book.url, '_blank');
    }

    // Fonctions d'affichage (view)
    function viewStudent(id) {
      const student = studentsData.find(s => s.id === id);
      if (!student) return;
      
      let details = `
        <h5>${student.name || ''}</h5>
        <p><strong>Classe:</strong> ${student.class || ''}</p>
        <p><strong>Sexe:</strong> ${student.gender || ''}</p>
        <p><strong>Date de naissance:</strong> ${student.dob ? new Date(student.dob).toLocaleDateString('fr-FR') : '-'}</p>
        <p><strong>Parent:</strong> ${student.parent || ''}</p>
        <p><strong>Téléphone:</strong> ${student.phone || ''}</p>
        <p><strong>Email:</strong> ${student.parentEmail || '-'}</p>
        <p><strong>Adresse:</strong> ${student.address || '-'}</p>
        <p><strong>Statut:</strong> ${student.status || 'Actif'}</p>
        ${student.notes ? `<p><strong>Remarques:</strong> ${student.notes}</p>` : ''}
      `;
      
      showNotification(details, 'info');
    }

    function viewTeacher(id) {
      const teacher = teachersData.find(t => t.id === id);
      if (!teacher) return;
      
      let details = `
        <h5>${teacher.name || ''}</h5>
        <p><strong>Email:</strong> ${teacher.email || ''}</p>
        <p><strong>Téléphone:</strong> ${teacher.phone || ''}</p>
        <p><strong>Matière:</strong> ${teacher.subject || ''}</p>
        <p><strong>Classes:</strong> ${teacher.classes || ''}</p>
        <p><strong>Statut:</strong> ${teacher.status || 'Actif'}</p>
        <p><strong>Date d'embauche:</strong> ${teacher.hireDate ? new Date(teacher.hireDate).toLocaleDateString('fr-FR') : '-'}</p>
        <p><strong>Adresse:</strong> ${teacher.address || '-'}</p>
        ${teacher.qualifications ? `<p><strong>Qualifications:</strong> ${teacher.qualifications}</p>` : ''}
      `;
      
      showNotification(details, 'info');
    }

    // Afficher une notification
    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification');
      const title = document.getElementById('notification-title');
      const messageEl = document.getElementById('notification-message');
      
      notification.className = 'alert-notification alert';
      if (type === 'success') {
        notification.classList.add('alert-success');
        title.textContent = 'Succès!';
      } else if (type === 'danger') {
        notification.classList.add('alert-danger');
        title.textContent = 'Erreur!';
      } else if (type === 'warning') {
        notification.classList.add('alert-warning');
        title.textContent = 'Attention!';
      } else {
        notification.classList.add('alert-info');
        title.textContent = 'Information';
      }
      
      messageEl.innerHTML = message;
      notification.style.display = 'block';
      
      setTimeout(() => {
        notification.classList.add('show');
      }, 10);
      
      setTimeout(() => {
        hideNotification();
      }, 5000);
    }

    function hideNotification() {
      const notification = document.getElementById('notification');
      notification.classList.remove('show');
      setTimeout(() => {
        notification.style.display = 'none';
      }, 300);
    }

    // Déconnexion
    function logout() {
      if (confirm('Voulez-vous vraiment vous déconnecter ?')) {
        auth.signOut().then(() => {
          window.location.href = 'Auth.html';
        }).catch((error) => {
          showNotification('Erreur lors de la déconnexion: ' + error.message, 'danger');
        });
      }
    }

    // Initialisation au chargement
    document.addEventListener('DOMContentLoaded', function() {
      // Vérifier l'authentification
      auth.onAuthStateChanged((user) => {
        if (!user) {
          window.location.href = 'Auth.html';
        }
      });
    });
  </script>
</body>
</html>