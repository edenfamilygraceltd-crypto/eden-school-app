<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Portail Secr√©taire - Eden Family School</title>
  
  <!-- üîí S√âCURIT√â: Script d'authentification -->
  <script src="security-auth.js"></script>
  
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="responsive.css">
  
  <style>
    :root {
      --primary: #2c3e50;
      --primary-light: #34495e;
      --secondary: #3498db;
      --secondary-light: #5dade2;
      --accent: #16a085;
      --accent-light: #1abc9c;
      --success: #27ae60;
      --danger: #e74c3c;
      --warning: #f39c12;
      --info: #3498db;
      --light: #ecf0f1;
      --dark: #2c3e50;
      --gray: #7f8c8d;
      --gray-light: #bdc3c7;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: linear-gradient(135deg, var(--light) 0%, #dfe6e9 100%);
      min-height: 100vh;
      padding: 20px 0;
      color: var(--dark);
      display: flex;
      flex-direction: column;
    }
    
    .navbar {
      background: white !important;
      backdrop-filter: blur(10px);
      box-shadow: 0 2px 15px rgba(44, 62, 80, 0.08);
      border-radius: 12px;
      margin: 0 20px 20px 20px;
      border: 1px solid rgba(189, 195, 199, 0.2);
    }
    
    .navbar-brand {
      font-weight: 700;
      font-size: 1.5rem;
      background: linear-gradient(135deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .main-container {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(44, 62, 80, 0.1);
      margin: 0 20px 20px 20px;
      border: 1px solid rgba(189, 195, 199, 0.3);
      flex: 1;
    }
    
    .sidebar {
      background: linear-gradient(160deg, var(--primary) 0%, var(--primary-light) 100%);
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 8px 20px rgba(44, 62, 80, 0.15);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .sidebar .list-group-item {
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.9);
      margin-bottom: 8px;
      border-radius: 10px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      font-weight: 500;
    }
    
    .sidebar .list-group-item:hover {
      background: rgba(255, 255, 255, 0.15);
      transform: translateX(5px);
      border-color: rgba(255, 255, 255, 0.2);
    }
    
    .sidebar .list-group-item.active {
      background: white;
      color: var(--primary);
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(44, 62, 80, 0.15);
      border: 1px solid white;
    }
    
    .stat-card {
      background: white;
      border-radius: 14px;
      padding: 20px;
      color: var(--dark);
      text-align: center;
      margin-bottom: 15px;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      cursor: pointer;
      border: 1px solid rgba(189, 195, 199, 0.3);
      position: relative;
      overflow: hidden;
    }
    
    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--secondary);
    }
    
    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(44, 62, 80, 0.12);
      border-color: var(--secondary-light);
    }
    
    .stat-card.students::before {
      background: linear-gradient(90deg, var(--secondary), var(--secondary-light));
    }
    
    .stat-card.teachers::before {
      background: linear-gradient(90deg, var(--accent), var(--accent-light));
    }
    
    .stat-card.assignments::before {
      background: linear-gradient(90deg, var(--warning), #f1c40f);
    }
    
    .stat-card.books::before {
      background: linear-gradient(90deg, var(--success), #2ecc71);
    }
    
    .stat-card i {
      font-size: 2.5rem;
      margin-bottom: 10px;
      display: block;
    }
    
    .stat-card.students i {
      color: var(--secondary);
    }
    
    .stat-card.teachers i {
      color: var(--accent);
    }
    
    .stat-card.assignments i {
      color: var(--warning);
    }
    
    .stat-card.books i {
      color: var(--success);
    }
    
    .stat-card h2 {
      font-size: 2.5rem;
      font-weight: 700;
      margin: 10px 0;
      color: var(--dark);
    }
    
    .stat-card small {
      font-size: 0.9rem;
      color: var(--gray);
      font-weight: 500;
    }
    
    .card {
      border: 1px solid rgba(189, 195, 199, 0.3);
      border-radius: 14px;
      box-shadow: 0 4px 15px rgba(44, 62, 80, 0.08);
      margin-bottom: 20px;
      overflow: hidden;
      transition: all 0.3s ease;
    }
    
    .card:hover {
      box-shadow: 0 8px 25px rgba(44, 62, 80, 0.12);
    }
    
    .card-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      font-weight: 600;
      padding: 18px 20px;
      border: none;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .btn-primary {
      background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
      border: none;
      padding: 10px 25px;
      border-radius: 10px;
      font-weight: 600;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      color: white;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(52, 152, 219, 0.3);
      background: linear-gradient(135deg, var(--secondary-light) 0%, var(--secondary) 100%);
    }
    
    .btn-outline-primary {
      color: var(--secondary);
      border-color: var(--secondary);
    }
    
    .btn-outline-primary:hover {
      background: var(--secondary);
      border-color: var(--secondary);
    }
    
    .btn-light {
      background: var(--light);
      border-color: var(--gray-light);
      color: var(--dark);
    }
    
    .table {
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid rgba(189, 195, 199, 0.3);
    }
    
    .table thead {
      background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary) 100%);
      color: white;
    }
    
    .table th {
      font-weight: 600;
      border: none;
      padding: 15px;
    }
    
    .table td {
      padding: 12px 15px;
      vertical-align: middle;
      border-color: rgba(189, 195, 199, 0.2);
    }
    
    .table tbody tr {
      transition: background 0.2s ease;
    }
    
    .table tbody tr:hover {
      background: rgba(236, 240, 241, 0.5);
    }
    
    .badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-weight: 600;
      font-size: 0.85rem;
    }
    
    .badge.bg-primary {
      background: var(--secondary) !important;
    }
    
    .badge.bg-info {
      background: var(--info) !important;
    }
    
    .badge.bg-success {
      background: var(--success) !important;
    }
    
    .badge.bg-warning {
      background: var(--warning) !important;
    }
    
    .badge.bg-secondary {
      background: var(--gray) !important;
    }
    
    .modal-content {
      border-radius: 16px;
      border: 1px solid rgba(189, 195, 199, 0.3);
      overflow: hidden;
      box-shadow: 0 20px 40px rgba(44, 62, 80, 0.15);
    }
    
    .modal-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      border: none;
      padding: 20px;
    }
    
    .form-control, .form-select {
      border-radius: 10px;
      border: 2px solid var(--gray-light);
      padding: 12px 15px;
      transition: all 0.3s ease;
      font-size: 0.95rem;
    }
    
    .form-control:focus, .form-select:focus {
      border-color: var(--secondary);
      box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.1);
    }
    
    .btn-group-sm .btn {
      border-radius: 8px;
      margin: 0 2px;
      padding: 5px 10px;
    }
    
    .search-box {
      position: relative;
      margin-bottom: 20px;
    }
    
    .search-box input {
      padding-left: 45px;
      border-radius: 10px;
      border: 2px solid var(--gray-light);
    }
    
    .search-box i {
      position: absolute;
      left: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--gray);
    }
    
    .academic-nav {
      background: white;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 3px 10px rgba(44, 62, 80, 0.05);
      border: 1px solid rgba(189, 195, 199, 0.2);
    }
    
    .academic-nav .list-group-item {
      border: 1px solid rgba(189, 195, 199, 0.3);
      border-radius: 8px;
      margin-bottom: 8px;
      transition: all 0.3s ease;
      font-weight: 500;
    }
    
    .academic-nav .list-group-item:hover {
      background: rgba(52, 152, 219, 0.08);
      color: var(--secondary);
      border-color: var(--secondary-light);
    }
    
    .academic-nav .list-group-item.active {
      background: linear-gradient(135deg, var(--secondary) 0%, var(--secondary-light) 100%);
      color: white;
      border-color: var(--secondary);
    }
    
    .book-card {
      background: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 20px;
      border: 1px solid rgba(189, 195, 199, 0.2);
      box-shadow: 0 4px 12px rgba(44, 62, 80, 0.08);
      transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
    
    .book-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 25px rgba(44, 62, 80, 0.12);
    }
    
    .audio-player {
      background: var(--light);
      border-radius: 10px;
      padding: 15px;
      margin-top: 15px;
    }
    
    .audio-player audio {
      width: 100%;
      border-radius: 8px;
    }
    
    .book-cover {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 8px;
      margin-bottom: 15px;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .fade-in {
      animation: fadeIn 0.5s ease;
    }
    
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--gray);
    }
    
    .loading i {
      font-size: 2rem;
      margin-bottom: 10px;
      color: var(--secondary);
    }
    
    .alert-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 9999;
      min-width: 300px;
      max-width: 400px;
      opacity: 0;
      transform: translateX(100%);
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border-radius: 12px;
      box-shadow: 0 8px 25px rgba(44, 62, 80, 0.15);
      border: none;
    }
    
    .alert-notification.show {
      opacity: 1;
      transform: translateX(0);
    }
    
    .alert-success {
      background: var(--success);
      color: white;
      border-left: 4px solid #27ae60;
    }
    
    .alert-danger {
      background: var(--danger);
      color: white;
      border-left: 4px solid #c0392b;
    }
    
    .alert-warning {
      background: var(--warning);
      color: white;
      border-left: 4px solid #e67e22;
    }
    
    .alert-info {
      background: var(--info);
      color: white;
      border-left: 4px solid #2980b9;
    }
    
    .btn-close-white {
      filter: invert(1) grayscale(100%) brightness(200%);
    }
    
    .text-muted {
      color: var(--gray) !important;
    }
    
    .btn-outline-danger {
      color: var(--danger);
      border-color: var(--danger);
    }
    
    .btn-outline-danger:hover {
      background: var(--danger);
      border-color: var(--danger);
    }
    
    .btn-outline-info {
      color: var(--info);
      border-color: var(--info);
    }
    
    .btn-outline-info:hover {
      background: var(--info);
      border-color: var(--info);
    }
    
    /* Personnalisation de la scrollbar */
    ::-webkit-scrollbar {
      width: 8px;
      height: 8px;
    }
    
    ::-webkit-scrollbar-track {
      background: var(--light);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb {
      background: var(--gray-light);
      border-radius: 4px;
    }
    
    ::-webkit-scrollbar-thumb:hover {
      background: var(--gray);
    }
    
    /* Effets de survol pour les boutons d'action */
    .btn-outline-primary, .btn-outline-info, .btn-outline-danger {
      transition: all 0.2s ease;
    }
    
    .btn-outline-primary:hover, .btn-outline-info:hover, .btn-outline-danger:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    /* Am√©lioration des ombres */
    .card, .sidebar, .main-container, .navbar, .book-card {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
    }
    
    /* Animation pour les ic√¥nes */
    .bi {
      transition: transform 0.2s ease;
    }
    
    .btn:hover .bi {
      transform: scale(1.1);
    }
    
    /* Style pour les badges dans les tableaux */
    .table .badge {
      font-size: 0.75rem;
      padding: 4px 10px;
    }
    
    /* Footer */
    .footer {
      background: var(--primary);
      color: white;
      padding: 40px 0 20px;
      margin-top: auto;
      border-top-left-radius: 16px;
      border-top-right-radius: 16px;
    }
    
    .footer h5 {
      color: white;
      margin-bottom: 20px;
      font-weight: 600;
    }
    
    .footer-links {
      list-style: none;
      padding: 0;
    }
    
    .footer-links li {
      margin-bottom: 10px;
    }
    
    .footer-links a {
      color: rgba(255, 255, 255, 0.8);
      text-decoration: none;
      transition: all 0.3s ease;
    }
    
    .footer-links a:hover {
      color: white;
      padding-left: 5px;
    }
    
    .social-icons {
      display: flex;
      gap: 15px;
      margin-top: 20px;
    }
    
    .social-icons a {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      color: white;
      font-size: 1.2rem;
      transition: all 0.3s ease;
    }
    
    .social-icons a:hover {
      background: var(--secondary);
      transform: translateY(-3px);
    }
    
    .copyright {
      text-align: center;
      padding-top: 20px;
      margin-top: 30px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      color: rgba(255, 255, 255, 0.6);
      font-size: 0.9rem;
    }
    
    /* Responsive adjustments */
    @media (max-width: 768px) {
      .main-container {
        padding: 15px;
        margin: 0 10px 15px 10px;
        border-radius: 12px;
      }
      
      .navbar {
        margin: 0 10px 15px 10px;
        padding: 10px 15px;
        border-radius: 10px;
      }
      
      .stat-card h2 {
        font-size: 1.75rem;
      }
      
      .footer {
        padding: 20px 15px 15px;
      }

      body {
        font-size: 14px;
      }

      input, select, textarea, button {
        font-size: 15px;
        min-height: 44px;
      }

      .col-lg-2, .col-md-3 {
        margin-bottom: 1rem;
      }
    }

    /* Tr√®s petits √©crans (320px - 479px) */
    @media (max-width: 479px) {
      body {
        font-size: 13px;
        overflow-x: hidden;
      }

      .main-container {
        padding: 10px;
        margin: 0 5px 10px 5px;
        border-radius: 10px;
      }

      .navbar {
        margin: 0 5px 10px 5px;
        padding: 8px 10px;
        border-radius: 8px;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .navbar h1, .navbar-brand {
        font-size: 1rem;
      }

      .d-flex {
        flex-direction: column;
        gap: 0.5rem;
      }

      .stat-card {
        padding: 0.75rem;
        margin-bottom: 0.75rem;
        border-radius: 8px;
      }

      .stat-card h2 {
        font-size: 1.2rem;
      }

      .stat-card .stat-value {
        font-size: 1rem;
      }

      h1 { font-size: 1.2rem; }
      h2 { font-size: 1.1rem; }
      h3, h4 { font-size: 0.95rem; }

      .form-label {
        font-size: 0.85rem;
        margin-bottom: 0.25rem;
      }

      input[type="text"],
      input[type="email"],
      input[type="tel"],
      input[type="date"],
      input[type="number"],
      select,
      textarea {
        font-size: 16px;
        padding: 0.75rem;
        width: 100%;
        border-radius: 6px;
        min-height: 44px;
      }

      button, .btn {
        padding: 0.75rem;
        font-size: 0.9rem;
        width: 100%;
        border-radius: 6px;
        min-height: 44px;
      }

      .row {
        margin: 0;
        gap: 0.5rem;
      }

      [class*="col-"] {
        padding: 0.25rem;
        margin-bottom: 0.5rem;
      }

      .col-md-4, .col-lg-2, .col-lg-10 {
        width: 100%;
      }

      table {
        font-size: 0.7rem;
      }

      table th, table td {
        padding: 0.35rem;
      }

      .modal-dialog {
        margin: 0.5rem;
        width: 95%;
        max-width: 95%;
      }

      .modal-content {
        border-radius: 8px;
      }

      .modal-body {
        padding: 0.75rem;
      }

      .modal-header, .modal-footer {
        padding: 0.5rem;
      }

      .alert-notification {
        max-width: 95%;
        right: 5px;
        left: 5px;
        font-size: 0.8rem;
        padding: 0.75rem;
        border-radius: 6px;
      }

      .footer {
        padding: 15px 10px 10px;
        font-size: 0.75rem;
      }

      .footer h5 {
        font-size: 0.9rem;
      }

      .footer ul li {
        font-size: 0.75rem;
      }

      .card {
        border-radius: 8px;
        margin-bottom: 0.75rem;
      }

      .card-header {
        padding: 0.5rem;
        font-size: 0.9rem;
      }

      .card-body {
        padding: 0.5rem;
      }

      .badge {
        font-size: 0.65rem;
        padding: 0.25em 0.4em;
      }

      .sidebar {
        padding: 15px;
      }

      .sidebar .list-group-item {
        padding: 0.75rem;
        font-size: 0.9rem;
        margin-bottom: 0.5rem;
      }

      .sidebar .list-group-item.active {
        padding: 0.75rem;
      }
    }

    /* Petites tablettes (480px - 767px) */
    @media (min-width: 480px) and (max-width: 767px) {
      body {
        font-size: 14px;
      }

      .main-container {
        padding: 12px;
        margin: 0 8px 12px 8px;
      }

      .navbar {
        margin: 0 8px 12px 8px;
        padding: 10px 12px;
      }

      .stat-card {
        padding: 1rem;
        font-size: 0.95rem;
      }

      input, select, textarea, button {
        font-size: 14px;
        min-height: 44px;
      }

      table {
        font-size: 0.85rem;
      }

      .col-md-4 {
        width: 50%;
      }

      h1 { font-size: 1.3rem; }
      h2 { font-size: 1.1rem; }
    }

    /* Tablettes moyennes (768px - 1023px) */
    @media (min-width: 768px) and (max-width: 1023px) {
      .main-container {
        padding: 20px;
      }

      .navbar {
        padding: 12px 20px;
      }

      .col-md-3 {
        width: 30%;
      }

      .col-md-4 {
        width: 50%;
      }
    }

    /* √âcrans larges (1024px+) */
    @media (min-width: 1024px) {
      .main-container {
        padding: 30px;
      }

      .col-lg-2 {
        width: 16.66%;
      }

      .col-lg-10 {
        width: 83.33%;
      }
    }

    /* Password toggle styles */
    .password-input-container {
        position: relative;
    }

    .password-toggle-btn {
        position: absolute;
        right: 12px;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        cursor: pointer;
        color: #999;
        font-size: 16px;
        padding: 4px 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: color 0.2s;
    }

    .password-toggle-btn:hover {
        color: #667eea;
    }

    .password-input-container input {
        padding-right: 40px !important;
    }
  </style>
  <script src="password-visibility.js"></script>
</head>
<body>
  <!-- Notification -->
  <div id="notification" class="alert-notification alert" role="alert" style="display: none;">
    <div class="d-flex justify-content-between align-items-start">
      <div>
        <strong id="notification-title"></strong>
        <div id="notification-message"></div>
      </div>
      <button type="button" class="btn-close btn-close-white" onclick="hideNotification()"></button>
    </div>
  </div>

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid">
      <a class="navbar-brand" href="#" style="display: flex; align-items: center; gap: 10px;">
        <img src="asset/img/logo_eden.png" alt="Logo Eden Family School" style="height: 40px; width: auto; object-fit: contain;">
        Eden Family School
      </a>
      <div class="d-flex align-items-center">
        <span class="me-3 text-muted">
          <i class="bi bi-person-circle me-1"></i>
          <span id="currentUser">Chargement...</span>
        </span>
        <a href="Auth.html" class="btn btn-outline-primary btn-sm me-2">
          <i class="bi bi-lock me-1"></i> Staff Access
        </a>
        <button class="btn btn-outline-danger btn-sm" onclick="logout()">
          <i class="bi bi-box-arrow-right me-1"></i> D√©connexion
        </button>
      </div>
    </div>
  </nav>

  <div class="main-container">
    <div class="row">
      <!-- Sidebar -->
      <div class="col-lg-2 col-md-3 mb-4">
        <div class="sidebar">
          <div class="list-group">
            <a href="#students" class="list-group-item active" data-section="students" onclick="switchSection('students')">
              <i class="bi bi-people-fill me-2"></i> √âl√®ves
            </a>
            <a href="#inscription" class="list-group-item" data-section="inscription" onclick="switchSection('inscription')">
              <i class="bi bi-pen-fill me-2"></i> Inscription
            </a>
            <a href="#teachers" class="list-group-item" data-section="teachers" onclick="switchSection('teachers')">
              <i class="bi bi-person-badge-fill me-2"></i> Enseignants
            </a>
            <a href="#academic" class="list-group-item" data-section="academic" onclick="switchSection('academic')">
              <i class="bi bi-journal-text me-2"></i> Acad√©mique
            </a>
            <a href="#library" class="list-group-item" data-section="library" onclick="switchSection('library')">
              <i class="bi bi-book-fill me-2"></i> Biblioth√®que
            </a>
          </div>
        </div>
        
        <!-- Statistiques -->
        <div class="mt-4">
          <div class="stat-card students" onclick="switchSection('students')">
            <i class="bi bi-people-fill"></i>
            <h2 id="statsStudents">0</h2>
            <small>√âl√®ves actifs</small>
          </div>
          <div class="stat-card" onclick="switchSection('inscription')" style="background: linear-gradient(135deg, #16a085, #117a8b); color: white; cursor: pointer;">
            <i class="bi bi-pen-fill"></i>
            <h2 id="statsInscriptions">0</h2>
            <small>Inscriptions</small>
          </div>
          <div class="stat-card teachers" onclick="switchSection('teachers')">
            <i class="bi bi-person-badge-fill"></i>
            <h2 id="statsTeachers">0</h2>
            <small>Enseignants</small>
          </div>
          <div class="stat-card assignments" onclick="switchSection('academic')">
            <i class="bi bi-journal-text"></i>
            <h2 id="statsAssignments">0</h2>
            <small>Devoirs</small>
          </div>
          <div class="stat-card books" onclick="switchSection('library')">
            <i class="bi bi-book-fill"></i>
            <h2 id="statsBooks">0</h2>
            <small>Livres</small>
          </div>
        </div>
      </div>

      <!-- Main Content -->
      <div class="col-lg-10 col-md-9">
        <!-- Section Inscription -->
        <div id="section-inscription" class="content-section" style="display: none;">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0"><i class="bi bi-pen-fill me-2"></i>Formulaire d'Inscription Scolaire</h5>
            </div>
            <div class="card-body">
              <form id="inscriptionFormSecretary" style="max-width: 900px; margin: 0 auto;">
                <!-- Info Enfant -->
                <div style="background: #E8EAF6; padding: 1rem; margin: 1.5rem 0 1rem; border-radius: 8px; font-weight: bold; color: var(--dark);">INFORMATION DE L'ENFANT</div>
                
                <div class="row">
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-person-fill"></i> Nom et pr√©nom *</label>
                    <input type="text" id="nomPrenomSec" name="nomPrenom" class="form-control" required>
                    <div id="nomPrenomErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-calendar-event"></i> Date de naissance *</label>
                    <input type="date" id="dateNaissanceSec" name="dateNaissance" class="form-control" required>
                    <div id="dateNaissanceErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-building"></i> √âcole de provenance *</label>
                    <input type="text" id="ecoleProvenanceSec" name="ecoleProvenance" class="form-control" required>
                    <div id="ecoleProvenanceErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                </div>

                <!-- Sexe -->
                <div class="mb-3">
                  <label class="form-label"><i class="bi bi-gender-ambiguous"></i> Sexe *</label>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" id="garconSec" name="sexe" value="GAR√áON" required>
                    <label class="form-check-label" for="garconSec">
                      <i class="bi bi-person-fill"></i> GAR√áON
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" id="filleSec" name="sexe" value="FILLE" required>
                    <label class="form-check-label" for="filleSec">
                      <i class="bi bi-person-fill"></i> FILLE
                    </label>
                  </div>
                  <div id="sexeErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                </div>

                <!-- Niveau Scolaire -->
                <div style="background: #E8EAF6; padding: 1rem; margin: 1.5rem 0 1rem; border-radius: 8px; font-weight: bold; color: var(--dark);">NIVEAU SCOLAIRE</div>
                
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-label"><i class="bi bi-mortarboard"></i> Section *</label>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" id="maternelleSec" name="section" value="MATERNELLE" required onchange="updateSectionSec()">
                      <label class="form-check-label" for="maternelleSec">
                        MATERNELLE
                      </label>
                    </div>
                    <div class="form-check">
                      <input class="form-check-input" type="radio" id="primaireSec" name="section" value="PRIMAIRE" required onchange="updateSectionSec()">
                      <label class="form-check-label" for="primaireSec">
                        PRIMAIRE
                      </label>
                    </div>
                    <div id="sectionErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  
                  <div class="col-md-6 mb-3" id="niveauMaternelleGroupSec" style="display: none;">
                    <label class="form-label"><i class="bi bi-star-fill"></i> Niveau maternelle *</label>
                    <select id="niveauMaternelleSec" name="niveauMaternelle" class="form-control">
                      <option value="">S√©lectionnez</option>
                      <option value="N1">N1</option>
                      <option value="N2">N2</option>
                      <option value="N3">N3</option>
                    </select>
                    <div id="niveauMaternelleErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  
                  <div class="col-md-6 mb-3" id="niveauPrimaireGroupSec" style="display: none;">
                    <label class="form-label"><i class="bi bi-book-fill"></i> Niveau primaire *</label>
                    <select id="niveauPrimaireSec" name="niveauPrimaire" class="form-control">
                      <option value="">S√©lectionnez</option>
                      <option value="P1">P1</option>
                      <option value="P2">P2</option>
                      <option value="P3">P3</option>
                      <option value="P4">P4</option>
                      <option value="P5">P5</option>
                    </select>
                    <div id="niveauPrimaireErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  
                  <div class="col-md-6 mb-3" id="sdmsGroupSec" style="display: none;">
                    <label class="form-label"><i class="bi bi-card-text"></i> SDMS Code (Obligatoire) *</label>
                    <input type="text" id="sdmsCodeSec" name="sdmsCode" class="form-control" placeholder="Code SDMS">
                    <div id="sdmsCodeErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                </div>

                <!-- Branche -->
                <div style="background: #E8EAF6; padding: 1rem; margin: 1.5rem 0 1rem; border-radius: 8px; font-weight: bold; color: var(--dark);">BRANCHE</div>
                
                <div class="mb-3">
                  <label class="form-label"><i class="bi bi-building"></i> S√©lectionnez la branche *</label>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" id="brancheKacyiruSec" name="branche" value="KACYIRU" required onchange="updateContactInfoSec()">
                    <label class="form-check-label" for="brancheKacyiruSec">
                      KACYIRU
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" id="brancheGisoziSec" name="branche" value="GISOZI" required onchange="updateContactInfoSec()">
                    <label class="form-check-label" for="brancheGisoziSec">
                      GISOZI
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" id="brancheKimisagaraSec" name="branche" value="KIMISAGARA" required onchange="updateContactInfoSec()">
                    <label class="form-check-label" for="brancheKimisagaraSec">
                      KIMISAGARA
                    </label>
                  </div>
                  <div id="brancheErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                </div>

                <!-- Contact Info -->
                <div id="contactInfoSec" style="background: #FFF9C4; padding: 1.5rem; border-radius: 10px; margin: 2rem 0; border-left: 5px solid #FFC107; text-align: center; display: none;">
                  <p id="contactTextSec"></p>
                </div>

                <!-- Transport -->
                <div style="background: #E8EAF6; padding: 1rem; margin: 1.5rem 0 1rem; border-radius: 8px; font-weight: bold; color: var(--dark);">TRANSPORT</div>
                
                <div class="mb-3">
                  <label class="form-label"><i class="bi bi-bus-front"></i> Transport bus *</label>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" id="transportOuiSec" name="transport" value="OUI" required>
                    <label class="form-check-label" for="transportOuiSec">
                      OUI
                    </label>
                  </div>
                  <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" id="transportNonSec" name="transport" value="NON" required>
                    <label class="form-check-label" for="transportNonSec">
                      NON
                    </label>
                  </div>
                  <div id="transportErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                </div>

                <!-- Chef de Famille -->
                <div style="background: #E8EAF6; padding: 1rem; margin: 1.5rem 0 1rem; border-radius: 8px; font-weight: bold; color: var(--dark);">CHEF DE FAMILLE</div>
                
                <div class="row">
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-person-fill"></i> Nom et pr√©nom *</label>
                    <input type="text" id="chefNomPrenomSec" name="chefNomPrenom" class="form-control" required>
                    <div id="chefNomPrenomErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-telephone"></i> T√©l√©phone *</label>
                    <input type="tel" id="chefTelephoneSec" name="chefTelephone" pattern="[0-9]{10}" class="form-control" required>
                    <div id="chefTelephoneErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-card-text"></i> Pi√®ce d'identit√© *</label>
                    <input type="text" id="chefPieceIdentiteSec" name="chefPieceIdentite" class="form-control" required>
                    <div id="chefPieceIdentiteErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                </div>

                <!-- Conjoint (Optionnel) -->
                <div style="background: #E8EAF6; padding: 1rem; margin: 1.5rem 0 1rem; border-radius: 8px; font-weight: bold; color: var(--dark);">CONJOINT(E) (Optionnel)</div>
                
                <div class="row">
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-person-fill"></i> Nom et pr√©nom</label>
                    <input type="text" id="conjointNomPrenomSec" name="conjointNomPrenom" class="form-control">
                  </div>
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-telephone"></i> T√©l√©phone</label>
                    <input type="tel" id="conjointTelephoneSec" name="conjointTelephone" pattern="[0-9]{10}" class="form-control">
                  </div>
                  <div class="col-md-4 mb-3">
                    <label class="form-label"><i class="bi bi-card-text"></i> Pi√®ce d'identit√©</label>
                    <input type="text" id="conjointPieceIdentiteSec" name="conjointPieceIdentite" class="form-control">
                  </div>
                </div>

                <!-- Adresse -->
                <div style="background: #E8EAF6; padding: 1rem; margin: 1.5rem 0 1rem; border-radius: 8px; font-weight: bold; color: var(--dark);">ADRESSE</div>
                
                <div class="row">
                  <div class="col-md-3 mb-3">
                    <label class="form-label"><i class="bi bi-geo-alt"></i> Ville *</label>
                    <select id="villeSec" name="ville" class="form-control" required>
                      <option value="">S√©lectionnez</option>
                      <option value="Kigali">Kigali</option>
                      <option value="Butare">Butare</option>
                      <option value="Gisenyi">Gisenyi</option>
                      <option value="Ruhengeri">Ruhengeri</option>
                      <option value="Gitarama">Gitarama</option>
                      <option value="Kibungo">Kibungo</option>
                    </select>
                    <div id="villeErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-3 mb-3">
                    <label class="form-label"><i class="bi bi-map"></i> Secteur *</label>
                    <input type="text" id="secteurSec" name="secteur" class="form-control" required>
                    <div id="secteurErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-3 mb-3">
                    <label class="form-label"><i class="bi bi-signpost-2"></i> Umurenge *</label>
                    <input type="text" id="umurengeSec" name="umurenge" class="form-control" required>
                    <div id="umurengeErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-3 mb-3">
                    <label class="form-label"><i class="bi bi-house"></i> Akagari *</label>
                    <input type="text" id="akagariSec" name="akagari" class="form-control" required>
                    <div id="akagariErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                  <div class="col-md-3 mb-3">
                    <label class="form-label"><i class="bi bi-street-view"></i> Umudugudu *</label>
                    <input type="text" id="umuduguduSec" name="umudugudu" class="form-control" required>
                    <div id="umuduguduErrorSec" style="color: var(--danger); font-size: 0.85em; margin-top: 0.3rem; display: none;"></div>
                  </div>
                </div>

                <!-- Bouton -->
                <div class="text-center mt-4">
                  <button type="button" class="btn btn-primary btn-lg" onclick="submitSecretaryInscription()">
                    <i class="bi bi-send"></i> Soumettre l'inscription
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0"><i class="bi bi-people-fill me-2"></i>Gestion des √âl√®ves</h5>
              <button class="btn btn-light btn-sm" onclick="openAddStudentModal()">
                <i class="bi bi-plus-circle me-1"></i> Nouvel √âl√®ve
              </button>
            </div>
            <div class="card-body">
              <div class="search-box">
                <i class="bi bi-search"></i>
                <input type="text" class="form-control" id="searchStudent" placeholder="Rechercher un √©l√®ve..." oninput="filterStudents()">
              </div>
              <div class="table-responsive">
                <table class="table table-hover align-middle">
                  <thead>
                    <tr>
                      <th><i class="bi bi-person me-1"></i>Nom Complet</th>
                      <th><i class="bi bi-building me-1"></i>Classe</th>
                      <th><i class="bi bi-gender-ambiguous me-1"></i>Sexe</th>
                      <th><i class="bi bi-people me-1"></i>Parent</th>
                      <th><i class="bi bi-telephone me-1"></i>T√©l√©phone</th>
                      <th><i class="bi bi-calendar me-1"></i>Date Ajout</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="studentsTable">
                    <!-- Les √©l√®ves seront charg√©s ici -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Enseignants -->
        <div id="section-teachers" class="content-section" style="display: none;">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0"><i class="bi bi-person-badge-fill me-2"></i>Gestion des Enseignants</h5>
              <button class="btn btn-light btn-sm" onclick="openAddTeacherModal()">
                <i class="bi bi-plus-circle me-1"></i> Nouvel Enseignant
              </button>
            </div>
            <div class="card-body">
              <div class="search-box">
                <i class="bi bi-search"></i>
                <input type="text" class="form-control" id="searchTeacher" placeholder="Rechercher un enseignant..." oninput="filterTeachers()">
              </div>
              <div class="table-responsive">
                <table class="table table-hover align-middle">
                  <thead>
                    <tr>
                      <th><i class="bi bi-person me-1"></i>Nom</th>
                      <th><i class="bi bi-envelope me-1"></i>Email</th>
                      <th><i class="bi bi-telephone me-1"></i>T√©l√©phone</th>
                      <th><i class="bi bi-book me-1"></i>Mati√®re</th>
                      <th><i class="bi bi-check-circle me-1"></i>Statut</th>
                      <th>Actions</th>
                    </tr>
                  </thead>
                  <tbody id="teachersTable">
                    <!-- Les enseignants seront charg√©s ici -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Acad√©mique -->
        <div id="section-academic" class="content-section" style="display: none;">
          <div class="card">
            <div class="card-header">
              <h5 class="mb-0"><i class="bi bi-journal-text me-2"></i>Gestion Acad√©mique</h5>
            </div>
            <div class="card-body">
              <div class="row">
                <div class="col-md-3">
                  <div class="academic-nav list-group">
                    <a href="#assignments" class="list-group-item active" onclick="switchAcademic('assignments')">
                      <i class="bi bi-clipboard-check me-2"></i>Devoirs
                    </a>
                    <a href="#tests" class="list-group-item" onclick="switchAcademic('tests')">
                      <i class="bi bi-file-text me-2"></i>Tests
                    </a>
                    <a href="#exams" class="list-group-item" onclick="switchAcademic('exams')">
                      <i class="bi bi-pen me-2"></i>Examens
                    </a>
                    <a href="#vacation" class="list-group-item" onclick="switchAcademic('vacation')">
                      <i class="bi bi-sun me-2"></i>Travaux Vacances
                    </a>
                  </div>
                </div>
                <div class="col-md-9">
                  <div id="academic-assignments" class="academic-content">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-clipboard-check me-2"></i>Gestion des Devoirs</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddAssignmentModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un devoir
                      </button>
                    </div>
                    <div id="assignmentsList"></div>
                  </div>
                  <div id="academic-tests" class="academic-content" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-file-text me-2"></i>Gestion des Tests</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddTestModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un test
                      </button>
                    </div>
                    <div id="testsList"></div>
                  </div>
                  <div id="academic-exams" class="academic-content" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-pen me-2"></i>Gestion des Examens</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddExamModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un examen
                      </button>
                    </div>
                    <div id="examsList"></div>
                  </div>
                  <div id="academic-vacation" class="academic-content" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="mb-0"><i class="bi bi-sun me-2"></i>Travaux de Vacances</h6>
                      <button class="btn btn-primary btn-sm" onclick="openAddVacationWorkModal()">
                        <i class="bi bi-plus-circle me-1"></i> Ajouter un travail
                      </button>
                    </div>
                    <div id="vacationList"></div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Section Biblioth√®que -->
        <div id="section-library" class="content-section" style="display: none;">
          <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
              <h5 class="mb-0"><i class="bi bi-book-fill me-2"></i>Biblioth√®que en Ligne</h5>
              <div class="btn-group">
                <button class="btn btn-light btn-sm" onclick="openAddBookModal()">
                  <i class="bi bi-plus-circle me-1"></i> Ajouter un Livre
                </button>
                <button class="btn btn-light btn-sm" onclick="openAddAudioBookModal()">
                  <i class="bi bi-headphones me-1"></i> Ajouter un Livre Audio
                </button>
              </div>
            </div>
            <div class="card-body">
              <div class="row mb-4">
                <div class="col-md-6">
                  <div class="search-box">
                    <i class="bi bi-search"></i>
                    <input type="text" class="form-control" id="searchBook" placeholder="Rechercher un livre..." oninput="filterBooks()">
                  </div>
                </div>
                <div class="col-md-6">
                  <select class="form-select" id="bookFilter" onchange="filterBooks()">
                    <option value="all">Tous les livres</option>
                    <option value="text">Livres texte</option>
                    <option value="audio">Livres audio</option>
                    <option value="available">Disponibles</option>
                  </select>
                </div>
              </div>
              
              <div class="row" id="libraryBooks">
                <!-- Les livres seront charg√©s ici -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="container">
      <div class="row">
        <div class="col-lg-4 col-md-6 mb-4">
          <h5>√Ä propos d'Eden Family School</h5>
          <p>Notre √©cole offre une √©ducation de qualit√© combinant excellence acad√©mique et d√©veloppement personnel. Nous nous engageons √† fournir un environnement d'apprentissage stimulant pour chaque √©l√®ve.</p>
          <div class="social-icons">
            <a href="#"><i class="bi bi-facebook"></i></a>
            <a href="#"><i class="bi bi-twitter"></i></a>
            <a href="#"><i class="bi bi-instagram"></i></a>
            <a href="#"><i class="bi bi-youtube"></i></a>
          </div>
        </div>
        
        <div class="col-lg-4 col-md-6 mb-4">
          <h5>Liens Rapides</h5>
          <ul class="footer-links">
            <li><a href="#students"><i class="bi bi-chevron-right me-1"></i> Gestion des √âl√®ves</a></li>
            <li><a href="#teachers"><i class="bi bi-chevron-right me-1"></i> Gestion des Enseignants</a></li>
            <li><a href="#academic"><i class="bi bi-chevron-right me-1"></i> Section Acad√©mique</a></li>
            <li><a href="#library"><i class="bi bi-chevron-right me-1"></i> Biblioth√®que</a></li>
          </ul>
        </div>
        
        <div class="col-lg-4 col-md-6 mb-4">
          <h5>Contact & Aide</h5>
          <ul class="footer-links">
            <li><i class="bi bi-envelope me-2"></i> contact@edenfamilyschool.edu</li>
            <li><i class="bi bi-telephone me-2"></i> +33 1 23 45 67 89</li>
            <li><i class="bi bi-geo-alt me-2"></i> 123 Rue de l'√âducation, Paris</li>
            <li><a href="#"><i class="bi bi-question-circle me-1"></i> Centre d'Aide</a></li>
            <li><a href="#"><i class="bi bi-shield-check me-1"></i> Politique de Confidentialit√©</a></li>
            <li><a href="#"><i class="bi bi-file-text me-1"></i> Conditions d'Utilisation</a></li>
          </ul>
        </div>
      </div>
      
      <div class="copyright">
        <p>&copy; 2024 Eden Family School. Tous droits r√©serv√©s.</p>
        <p>Portail Secr√©taire - Version 2.0</p>
      </div>
    </div>
  </footer>

  <!-- Modal Ajouter/√âditer √âl√®ve -->
  <div class="modal fade" id="studentModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="studentModalTitle"><i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel √âl√®ve</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="studentForm">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-person me-1"></i>Nom Complet *</label>
                <input type="text" class="form-control" id="studentName" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-building me-1"></i>Classe *</label>
                <select class="form-select" id="studentClass" required>
                  <option value="">S√©lectionner une classe</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-gender-ambiguous me-1"></i>Sexe *</label>
                <select class="form-select" id="studentGender" required>
                  <option value="">S√©lectionner</option>
                  <option value="Masculin">Masculin</option>
                  <option value="F√©minin">F√©minin</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-calendar me-1"></i>Date de Naissance</label>
                <input type="date" class="form-control" id="studentDOB">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-people me-1"></i>Nom du Parent *</label>
                <input type="text" class="form-control" id="studentParent" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-telephone me-1"></i>T√©l√©phone Parent *</label>
                <input type="tel" class="form-control" id="studentPhone" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-envelope me-1"></i>Email du Parent</label>
                <input type="email" class="form-control" id="studentEmail">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-check-circle me-1"></i>Statut *</label>
                <select class="form-select" id="studentStatus" required>
                  <option value="Actif">Actif</option>
                  <option value="Inactif">Inactif</option>
                  <option value="Suspendu">Suspendu</option>
                </select>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label"><i class="bi bi-geo-alt me-1"></i>Adresse</label>
                <textarea class="form-control" id="studentAddress" rows="2"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label"><i class="bi bi-chat-text me-1"></i>Remarques</label>
                <textarea class="form-control" id="studentNotes" rows="2"></textarea>
              </div>
            </div>
            <input type="hidden" id="studentId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/√âditer Enseignant -->
  <div class="modal fade" id="teacherModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="teacherModalTitle"><i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel Enseignant</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="teacherForm">
            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-person me-1"></i>Nom Complet *</label>
                <input type="text" class="form-control" id="teacherName" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-envelope me-1"></i>Email *</label>
                <input type="email" class="form-control" id="teacherEmail" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-telephone me-1"></i>T√©l√©phone *</label>
                <input type="tel" class="form-control" id="teacherPhone" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-book me-1"></i>Mati√®re Enseign√©e *</label>
                <input type="text" class="form-control" id="teacherSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-check-circle me-1"></i>Statut *</label>
                <select class="form-select" id="teacherStatus" required>
                  <option value="Actif">Actif</option>
                  <option value="Inactif">Inactif</option>
                  <option value="Cong√©">Cong√©</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-calendar me-1"></i>Date d'Embauche</label>
                <input type="date" class="form-control" id="teacherHireDate">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-building me-1"></i>Classes Enseign√©es</label>
                <input type="text" class="form-control" id="teacherClasses" placeholder="CP, CE1, CE2...">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label"><i class="bi bi-geo-alt me-1"></i>Adresse</label>
                <input type="text" class="form-control" id="teacherAddress">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label"><i class="bi bi-chat-text me-1"></i>Qualifications</label>
                <textarea class="form-control" id="teacherQualifications" rows="2"></textarea>
              </div>
            </div>
            <input type="hidden" id="teacherId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/√âditer Devoir -->
  <div class="modal fade" id="assignmentModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="assignmentModalTitle"><i class="bi bi-clipboard-plus me-2"></i>Ajouter un Devoir</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="assignmentForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="assignmentTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="assignmentClass" required>
                  <option value="">S√©lectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Mati√®re *</label>
                <input type="text" class="form-control" id="assignmentSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de Remise *</label>
                <input type="datetime-local" class="form-control" id="assignmentDueDate" required>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="assignmentDesc" rows="4"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Instructions</label>
                <textarea class="form-control" id="assignmentInstructions" rows="3"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Points Maximum</label>
                <input type="number" class="form-control" id="assignmentPoints" value="20" min="1" max="100">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="assignmentStatus">
                  <option value="Actif">Actif</option>
                  <option value="Termin√©">Termin√©</option>
                  <option value="Annul√©">Annul√©</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="assignmentId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/√âditer Test -->
  <div class="modal fade" id="testModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="testModalTitle"><i class="bi bi-file-plus me-2"></i>Ajouter un Test</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="testForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="testTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="testClass" required>
                  <option value="">S√©lectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Mati√®re *</label>
                <input type="text" class="form-control" id="testSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date du Test *</label>
                <input type="datetime-local" class="form-control" id="testDate" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Dur√©e (minutes)</label>
                <input type="number" class="form-control" id="testDuration" value="60" min="15" max="180">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Note Maximale</label>
                <input type="number" class="form-control" id="testMaxScore" value="20" min="1" max="100">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="testDescription" rows="4"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Type de Test</label>
                <select class="form-select" id="testType">
                  <option value="Contr√¥le">Contr√¥le</option>
                  <option value="Interrogation">Interrogation</option>
                  <option value="Quiz">Quiz</option>
                  <option value="Oral">Oral</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="testStatus">
                  <option value="Planifi√©">Planifi√©</option>
                  <option value="Termin√©">Termin√©</option>
                  <option value="Annul√©">Annul√©</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="testId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/√âditer Examen -->
  <div class="modal fade" id="examModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="examModalTitle"><i class="bi bi-pen-plus me-2"></i>Ajouter un Examen</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="examForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="examTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="examClass" required>
                  <option value="">S√©lectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Mati√®re *</label>
                <input type="text" class="form-control" id="examSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de l'Examen *</label>
                <input type="datetime-local" class="form-control" id="examDate" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Dur√©e (minutes)</label>
                <input type="number" class="form-control" id="examDuration" value="120" min="60" max="240">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Coefficient</label>
                <input type="number" class="form-control" id="examCoefficient" value="1" min="1" max="5" step="0.5">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="examDescription" rows="4"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Type d'Examen</label>
                <select class="form-select" id="examType">
                  <option value="Partiel">Partiel</option>
                  <option value="Final">Final</option>
                  <option value="Rattrapage">Rattrapage</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="examStatus">
                  <option value="Planifi√©">Planifi√©</option>
                  <option value="En cours">En cours</option>
                  <option value="Corrig√©">Corrig√©</option>
                  <option value="Termin√©">Termin√©</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="examId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/√âditer Travail de Vacances -->
  <div class="modal fade" id="vacationWorkModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="vacationWorkModalTitle"><i class="bi bi-sun-plus me-2"></i>Ajouter un Travail de Vacances</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="vacationWorkForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre *</label>
                <input type="text" class="form-control" id="vacationWorkTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Classe *</label>
                <select class="form-select" id="vacationWorkClass" required>
                  <option value="">S√©lectionner</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Mati√®re *</label>
                <input type="text" class="form-control" id="vacationWorkSubject" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">P√©riode</label>
                <input type="text" class="form-control" id="vacationWorkPeriod" placeholder="Ex: Vacances de No√´l 2023" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de D√©but</label>
                <input type="date" class="form-control" id="vacationWorkStartDate">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Date de Fin</label>
                <input type="date" class="form-control" id="vacationWorkEndDate">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="vacationWorkDescription" rows="4"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Instructions</label>
                <textarea class="form-control" id="vacationWorkInstructions" rows="3"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Fichiers √† Fournir (liens)</label>
                <textarea class="form-control" id="vacationWorkFiles" rows="2" placeholder="https://exemple.com/document.pdf"></textarea>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="vacationWorkStatus">
                  <option value="Actif">Actif</option>
                  <option value="Termin√©">Termin√©</option>
                  <option value="Archiv√©">Archiv√©</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="vacationWorkId">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/√âditer Livre Texte -->
  <div class="modal fade" id="bookModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="bookModalTitle"><i class="bi bi-book-fill me-2"></i>Ajouter un Livre</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="bookForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre du Livre *</label>
                <input type="text" class="form-control" id="bookTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Auteur *</label>
                <input type="text" class="form-control" id="bookAuthor" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Cat√©gorie *</label>
                <select class="form-select" id="bookCategory" required>
                  <option value="">S√©lectionner</option>
                  <option value="Fiction">Fiction</option>
                  <option value="Science">Science</option>
                  <option value="Histoire">Histoire</option>
                  <option value="Math√©matiques">Math√©matiques</option>
                  <option value="Litt√©rature">Litt√©rature</option>
                  <option value="Langues">Langues</option>
                  <option value="Arts">Arts</option>
                  <option value="Scolaire">Scolaire</option>
                  <option value="Autres">Autres</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Classe Cible</label>
                <select class="form-select" id="bookClass">
                  <option value="Toutes">Toutes les classes</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">ISBN</label>
                <input type="text" class="form-control" id="bookISBN">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Ann√©e de Publication</label>
                <input type="number" class="form-control" id="bookYear" min="1900" max="2024">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="bookDescription" rows="3"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">URL du Livre (PDF ou Lien en ligne) *</label>
                <input type="url" class="form-control" id="bookUrl" placeholder="https://exemple.com/livre.pdf" required>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Image de Couverture (URL)</label>
                <input type="url" class="form-control" id="bookCover" placeholder="https://exemple.com/couverture.jpg">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Langue</label>
                <select class="form-select" id="bookLanguage">
                  <option value="Fran√ßais">Fran√ßais</option>
                  <option value="Anglais">Anglais</option>
                  <option value="Espagnol">Espagnol</option>
                  <option value="Arabe">Arabe</option>
                  <option value="Autre">Autre</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="bookStatus">
                  <option value="Disponible">Disponible</option>
                  <option value="Indisponible">Indisponible</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="bookId">
            <input type="hidden" id="bookType" value="text">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer le Livre
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ajouter/√âditer Livre Audio -->
  <div class="modal fade" id="audioBookModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="audioBookModalTitle"><i class="bi bi-headphones me-2"></i>Ajouter un Livre Audio</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <form id="audioBookForm">
            <div class="row">
              <div class="col-md-8 mb-3">
                <label class="form-label">Titre du Livre Audio *</label>
                <input type="text" class="form-control" id="audioBookTitle" required>
              </div>
              <div class="col-md-4 mb-3">
                <label class="form-label">Auteur/Narrateur *</label>
                <input type="text" class="form-control" id="audioBookAuthor" required>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Cat√©gorie *</label>
                <select class="form-select" id="audioBookCategory" required>
                  <option value="">S√©lectionner</option>
                  <option value="Fiction">Fiction</option>
                  <option value="Science">Science</option>
                  <option value="Histoire">Histoire</option>
                  <option value="Litt√©rature">Litt√©rature</option>
                  <option value="Jeunesse">Jeunesse</option>
                  <option value="√âducatif">√âducatif</option>
                  <option value="Autres">Autres</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Classe Cible</label>
                <select class="form-select" id="audioBookClass">
                  <option value="Toutes">Toutes les classes</option>
                  <optgroup label="NURSERY">
                    <option value="N1A">N1A (Nursery 1A)</option>
                    <option value="N1B">N1B (Nursery 1B)</option>
                    <option value="N1C">N1C (Nursery 1C)</option>
                    <option value="N2A">N2A (Nursery 2A)</option>
                    <option value="N2B">N2B (Nursery 2B)</option>
                    <option value="N2C">N2C (Nursery 2C)</option>
                    <option value="N3A">N3A (Nursery 3A)</option>
                    <option value="N3B">N3B (Nursery 3B)</option>
                    <option value="N3C">N3C (Nursery 3C)</option>
                  </optgroup>
                  <optgroup label="PRIMAIRE">
                    <option value="P1A">P1A</option>
                    <option value="P1B">P1B</option>
                    <option value="P1C">P1C</option>
                    <option value="P2A">P2A</option>
                    <option value="P2B">P2B</option>
                    <option value="P2C">P2C</option>
                    <option value="P3A">P3A</option>
                    <option value="P3B">P3B</option>
                    <option value="P3C">P3C</option>
                    <option value="P4A">P4A</option>
                    <option value="P4B">P4B</option>
                    <option value="P4C">P4C</option>
                    <option value="P5A">P5A</option>
                    <option value="P5B">P5B</option>
                    <option value="P5C">P5C</option>
                    <option value="P6A">P6A</option>
                    <option value="P6B">P6B</option>
                    <option value="P6C">P6C</option>
                  </optgroup>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Dur√©e (minutes)</label>
                <input type="number" class="form-control" id="audioBookDuration" min="1" max="600">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Ann√©e de Publication</label>
                <input type="number" class="form-control" id="audioBookYear" min="1900" max="2024">
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Description</label>
                <textarea class="form-control" id="audioBookDescription" rows="3"></textarea>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">URL du Fichier Audio *</label>
                <input type="url" class="form-control" id="audioBookUrl" placeholder="https://exemple.com/livre-audio.mp3" required>
                <small class="text-muted">Formats support√©s: MP3, WAV, OGG</small>
              </div>
              <div class="col-md-12 mb-3">
                <label class="form-label">Image de Couverture (URL)</label>
                <input type="url" class="form-control" id="audioBookCover" placeholder="https://exemple.com/couverture.jpg">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Langue</label>
                <select class="form-select" id="audioBookLanguage">
                  <option value="Fran√ßais">Fran√ßais</option>
                  <option value="Anglais">Anglais</option>
                  <option value="Espagnol">Espagnol</option>
                  <option value="Arabe">Arabe</option>
                  <option value="Autre">Autre</option>
                </select>
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Statut</label>
                <select class="form-select" id="audioBookStatus">
                  <option value="Disponible">Disponible</option>
                  <option value="Indisponible">Indisponible</option>
                </select>
              </div>
            </div>
            <input type="hidden" id="audioBookId">
            <input type="hidden" id="audioBookType" value="audio">
            <button type="submit" class="btn btn-primary">
              <i class="bi bi-check-circle me-1"></i> Enregistrer le Livre Audio
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database.js"></script>
  
  <!-- Firebase Configuration (Modern SDK) -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
    import { getAuth } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
    import { getDatabase } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyApUFNELOfgIe7rWEek9GLS9EIphNW09-A",
      authDomain: "edensmart-app.firebaseapp.com",
      projectId: "edensmart-app",
      storageBucket: "edensmart-app.firebasestorage.app",
      messagingSenderId: "1093120876724",
      appId: "1:1093120876724:web:bc37448cadd18d651c77e1",
      measurementId: "G-1FL70PZZSW"
    };

    window.firebaseApp = initializeApp(firebaseConfig);
    window.auth = getAuth(window.firebaseApp);
    window.database = getDatabase(window.firebaseApp);
  </script>

  <script>
    // Configuration Firebase - Nouvelle Base de Donn√©es
    const firebaseConfig = {
      apiKey: "AIzaSyApUFNELOfgIe7rWEek9GLS9EIphNW09-A",
      authDomain: "edensmart-app.firebaseapp.com",
      projectId: "edensmart-app",
      storageBucket: "edensmart-app.firebasestorage.app",
      messagingSenderId: "1093120876724",
      appId: "1:1093120876724:web:bc37448cadd18d651c77e1",
      measurementId: "G-1FL70PZZSW"
    };

    // Initialiser Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    // Variables globales
    let currentUser = null;
    let studentsData = [];
    let teachersData = [];
    let assignmentsData = [];
    let testsData = [];
    let examsData = [];
    let vacationWorksData = [];
    let booksData = [];
    let filteredStudents = [];
    let filteredTeachers = [];
    let filteredBooks = [];

    // V√©rifier l'authentification
    auth.onAuthStateChanged((user) => {
      if (user) {
        currentUser = user;
        document.getElementById('currentUser').textContent = user.email || 'Secr√©taire';
        loadAllData();
      } else {
        window.location.href = 'index.html';
      }
    });

    // Charger toutes les donn√©es
    function loadAllData() {
      loadStudents();
      loadTeachers();
      loadAssignments();
      loadTests();
      loadExams();
      loadVacationWorks();
      loadBooks();
    }

    // Charger les √©l√®ves
    function loadStudents() {
      const studentsRef = database.ref('students');
      studentsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        studentsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            studentsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        filteredStudents = [...studentsData];
        document.getElementById('statsStudents').textContent = studentsData.length;
        renderStudents();
      });
    }

    // Charger les enseignants
    function loadTeachers() {
      const teachersRef = database.ref('teachers');
      teachersRef.on('value', (snapshot) => {
        const data = snapshot.val();
        teachersData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            teachersData.push({
              id: key,
              ...data[key]
            });
          });
        }
        filteredTeachers = [...teachersData];
        document.getElementById('statsTeachers').textContent = teachersData.length;
        renderTeachers();
      });
    }

    // Charger les devoirs
    function loadAssignments() {
      const assignmentsRef = database.ref('assignments');
      assignmentsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        assignmentsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            assignmentsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        document.getElementById('statsAssignments').textContent = assignmentsData.length;
        renderAssignments();
      });
    }

    // Charger les tests
    function loadTests() {
      const testsRef = database.ref('tests');
      testsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        testsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            testsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        renderTests();
      });
    }

    // Charger les examens
    function loadExams() {
      const examsRef = database.ref('exams');
      examsRef.on('value', (snapshot) => {
        const data = snapshot.val();
        examsData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            examsData.push({
              id: key,
              ...data[key]
            });
          });
        }
        renderExams();
      });
    }

    // Charger les travaux de vacances
    function loadVacationWorks() {
      const vacationWorksRef = database.ref('vacationWorks');
      vacationWorksRef.on('value', (snapshot) => {
        const data = snapshot.val();
        vacationWorksData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            vacationWorksData.push({
              id: key,
              ...data[key]
            });
          });
        }
        renderVacationWorks();
      });
    }

    // Charger les livres
    function loadBooks() {
      const booksRef = database.ref('books');
      booksRef.on('value', (snapshot) => {
        const data = snapshot.val();
        booksData = [];
        if (data) {
          Object.keys(data).forEach((key) => {
            booksData.push({
              id: key,
              ...data[key]
            });
          });
        }
        filteredBooks = [...booksData];
        document.getElementById('statsBooks').textContent = booksData.length;
        renderBooks();
      });
    }

    // Navigation entre sections
    function switchSection(section) {
      document.querySelectorAll('.content-section').forEach(s => {
        s.style.display = 'none';
        s.classList.remove('fade-in');
      });
      
      const targetSection = document.getElementById('section-' + section);
      targetSection.style.display = 'block';
      setTimeout(() => targetSection.classList.add('fade-in'), 10);
      
      document.querySelectorAll('.sidebar .list-group-item').forEach(item => {
        item.classList.remove('active');
      });
      
      document.querySelector(`.sidebar .list-group-item[data-section="${section}"]`).classList.add('active');
    }

    // Navigation acad√©mique
    function switchAcademic(type) {
      document.querySelectorAll('.academic-content').forEach(c => {
        c.style.display = 'none';
      });
      
      document.getElementById('academic-' + type).style.display = 'block';
      
      document.querySelectorAll('.academic-nav .list-group-item').forEach(item => {
        item.classList.remove('active');
      });
      
      event.target.classList.add('active');
    }

    // Afficher les √©l√®ves
    function renderStudents() {
      const tbody = document.getElementById('studentsTable');
      
      if (filteredStudents.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" class="text-center text-muted py-5">
              <i class="bi bi-inbox" style="font-size: 3rem; opacity: 0.3;"></i>
              <p class="mt-2">Aucun √©l√®ve enregistr√©</p>
              <button class="btn btn-primary mt-2" onclick="openAddStudentModal()">
                <i class="bi bi-plus-circle me-1"></i> Ajouter un √©l√®ve
              </button>
            </td>
          </tr>`;
        return;
      }
      
      let html = '';
      filteredStudents.forEach(student => {
        const dateAdded = student.dateAdded ? new Date(student.dateAdded).toLocaleDateString('fr-FR') : '-';
        const dob = student.dob ? new Date(student.dob).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <tr>
            <td>
              <div class="d-flex align-items-center">
                <div class="me-2">
                  <i class="bi bi-person-circle" style="font-size: 1.5rem; color: ${student.gender === 'F√©minin' ? '#e74c3c' : '#3498db'}"></i>
                </div>
                <div>
                  <strong>${student.name || ''}</strong>
                  ${student.dob ? `<br><small class="text-muted">N√© le: ${dob}</small>` : ''}
                </div>
              </div>
            </td>
            <td><span class="badge bg-primary">${student.class || ''}</span></td>
            <td>${student.gender || ''}</td>
            <td>
              <div>
                <strong>${student.parent || ''}</strong>
                ${student.parentEmail ? `<br><small class="text-muted">${student.parentEmail}</small>` : ''}
              </div>
            </td>
            <td><i class="bi bi-telephone me-1"></i>${student.phone || ''}</td>
            <td><small>${dateAdded}</small></td>
            <td>
              <div class="btn-group btn-group-sm">
                <button class="btn btn-outline-info" onclick="viewStudent('${student.id}')" title="Voir">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-outline-primary" onclick="editStudent('${student.id}')" title="Modifier">
                  <i class="bi bi-pencil"></i>
                </button>
                <button class="btn btn-outline-danger" onclick="deleteStudent('${student.id}')" title="Supprimer">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }

    // Afficher les enseignants
    function renderTeachers() {
      const tbody = document.getElementById('teachersTable');
      
      if (filteredTeachers.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" class="text-center text-muted py-5">
              <i class="bi bi-inbox" style="font-size: 3rem; opacity: 0.3;"></i>
              <p class="mt-2">Aucun enseignant enregistr√©</p>
              <button class="btn btn-primary mt-2" onclick="openAddTeacherModal()">
                <i class="bi bi-plus-circle me-1"></i> Ajouter un enseignant
              </button>
            </td>
          </tr>`;
        return;
      }
      
      let html = '';
      filteredTeachers.forEach(teacher => {
        const status = teacher.status === 'Actif' ? 
          '<span class="badge bg-success"><i class="bi bi-check-circle me-1"></i>Actif</span>' : 
          teacher.status === 'Cong√©' ?
          '<span class="badge bg-warning"><i class="bi bi-clock me-1"></i>Cong√©</span>' :
          '<span class="badge bg-secondary"><i class="bi bi-x-circle me-1"></i>Inactif</span>';
        
        html += `
          <tr>
            <td><strong>${teacher.name || ''}</strong></td>
            <td><i class="bi bi-envelope me-1"></i>${teacher.email || ''}</td>
            <td><i class="bi bi-telephone me-1"></i>${teacher.phone || ''}</td>
            <td><span class="badge bg-info">${teacher.subject || ''}</span></td>
            <td>${status}</td>
            <td>
              <div class="btn-group btn-group-sm">
                <button class="btn btn-outline-info" onclick="viewTeacher('${teacher.id}')" title="Voir">
                  <i class="bi bi-eye"></i>
                </button>
                <button class="btn btn-outline-primary" onclick="editTeacher('${teacher.id}')" title="Modifier">
                  <i class="bi bi-pencil"></i>
                </button>
                <button class="btn btn-outline-danger" onclick="deleteTeacher('${teacher.id}')" title="Supprimer">
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </td>
          </tr>
        `;
      });
      
      tbody.innerHTML = html;
    }

    // Afficher les devoirs
    function renderAssignments() {
      const container = document.getElementById('assignmentsList');
      
      if (assignmentsData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun devoir enregistr√©. Cliquez sur "Ajouter un devoir" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      assignmentsData.forEach(assignment => {
        const dueDate = assignment.dueDate ? new Date(assignment.dueDate).toLocaleString('fr-FR') : '-';
        const createdDate = assignment.dateAdded ? new Date(assignment.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${assignment.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${assignment.class || ''}</span>
                    <span class="badge bg-info">${assignment.subject || ''}</span>
                    ${assignment.points ? `<span class="badge bg-warning">${assignment.points} points</span>` : ''}
                  </p>
                  ${assignment.description ? `<p class="mb-2">${assignment.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Cr√©√©: ${createdDate}</small>
                    <small><i class="bi bi-clock me-1"></i>√Ä rendre: ${dueDate}</small>
                    <small><i class="bi bi-flag me-1"></i>Statut: ${assignment.status || 'Actif'}</small>
                  </div>
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editAssignment('${assignment.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteAssignment('${assignment.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les tests
    function renderTests() {
      const container = document.getElementById('testsList');
      
      if (testsData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun test enregistr√©. Cliquez sur "Ajouter un test" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      testsData.forEach(test => {
        const testDate = test.date ? new Date(test.date).toLocaleString('fr-FR') : '-';
        const createdDate = test.dateAdded ? new Date(test.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${test.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${test.class || ''}</span>
                    <span class="badge bg-info">${test.subject || ''}</span>
                    <span class="badge bg-warning">${test.type || 'Contr√¥le'}</span>
                    ${test.maxScore ? `<span class="badge bg-success">${test.maxScore} points max</span>` : ''}
                  </p>
                  ${test.description ? `<p class="mb-2">${test.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Cr√©√©: ${createdDate}</small>
                    <small><i class="bi bi-clock me-1"></i>Date: ${testDate}</small>
                    ${test.duration ? `<small><i class="bi bi-hourglass me-1"></i>Dur√©e: ${test.duration} min</small>` : ''}
                    <small><i class="bi bi-flag me-1"></i>Statut: ${test.status || 'Planifi√©'}</small>
                  </div>
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editTest('${test.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteTest('${test.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les examens
    function renderExams() {
      const container = document.getElementById('examsList');
      
      if (examsData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun examen enregistr√©. Cliquez sur "Ajouter un examen" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      examsData.forEach(exam => {
        const examDate = exam.date ? new Date(exam.date).toLocaleString('fr-FR') : '-';
        const createdDate = exam.dateAdded ? new Date(exam.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${exam.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${exam.class || ''}</span>
                    <span class="badge bg-info">${exam.subject || ''}</span>
                    <span class="badge bg-warning">${exam.type || 'Partiel'}</span>
                    ${exam.coefficient ? `<span class="badge bg-success">Coeff: ${exam.coefficient}</span>` : ''}
                  </p>
                  ${exam.description ? `<p class="mb-2">${exam.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Cr√©√©: ${createdDate}</small>
                    <small><i class="bi bi-clock me-1"></i>Date: ${examDate}</small>
                    ${exam.duration ? `<small><i class="bi bi-hourglass me-1"></i>Dur√©e: ${exam.duration} min</small>` : ''}
                    <small><i class="bi bi-flag me-1"></i>Statut: ${exam.status || 'Planifi√©'}</small>
                  </div>
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editExam('${exam.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteExam('${exam.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les travaux de vacances
    function renderVacationWorks() {
      const container = document.getElementById('vacationList');
      
      if (vacationWorksData.length === 0) {
        container.innerHTML = `
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            Aucun travail de vacances enregistr√©. Cliquez sur "Ajouter un travail" pour commencer.
          </div>`;
        return;
      }
      
      let html = '';
      vacationWorksData.forEach(work => {
        const startDate = work.startDate ? new Date(work.startDate).toLocaleDateString('fr-FR') : '-';
        const endDate = work.endDate ? new Date(work.endDate).toLocaleDateString('fr-FR') : '-';
        const createdDate = work.dateAdded ? new Date(work.dateAdded).toLocaleDateString('fr-FR') : '-';
        
        html += `
          <div class="card mb-3">
            <div class="card-body">
              <div class="d-flex justify-content-between align-items-start">
                <div style="flex: 1;">
                  <h6 class="mb-1">${work.title || ''}</h6>
                  <p class="text-muted mb-2">
                    <span class="badge bg-primary me-2">${work.class || ''}</span>
                    <span class="badge bg-info">${work.subject || ''}</span>
                    <span class="badge bg-warning">${work.period || ''}</span>
                  </p>
                  ${work.description ? `<p class="mb-2">${work.description}</p>` : ''}
                  <div class="d-flex gap-3 flex-wrap">
                    <small><i class="bi bi-calendar me-1"></i>Cr√©√©: ${createdDate}</small>
                    <small><i class="bi bi-calendar-plus me-1"></i>D√©but: ${startDate}</small>
                    <small><i class="bi bi-calendar-check me-1"></i>Fin: ${endDate}</small>
                    <small><i class="bi bi-flag me-1"></i>Statut: ${work.status || 'Actif'}</small>
                  </div>
                  ${work.files ? `<small class="d-block mt-2"><i class="bi bi-paperclip me-1"></i>Fichiers: ${work.files}</small>` : ''}
                </div>
                <div class="btn-group btn-group-sm ms-3">
                  <button class="btn btn-outline-primary" onclick="editVacationWork('${work.id}')">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteVacationWork('${work.id}')">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Afficher les livres
    function renderBooks() {
      const container = document.getElementById('libraryBooks');
      
      if (filteredBooks.length === 0) {
        container.innerHTML = `
          <div class="col-12 text-center text-muted py-5">
            <i class="bi bi-book" style="font-size: 3rem; opacity: 0.3;"></i>
            <p class="mt-2">Aucun livre dans la biblioth√®que</p>
            <div class="mt-3">
              <button class="btn btn-primary me-2" onclick="openAddBookModal()">
                <i class="bi bi-plus-circle me-1"></i> Ajouter un livre
              </button>
              <button class="btn btn-secondary" onclick="openAddAudioBookModal()">
                <i class="bi bi-headphones me-1"></i> Ajouter un livre audio
              </button>
            </div>
          </div>`;
        return;
      }
      
      let html = '';
      filteredBooks.forEach(book => {
        const isAudioBook = book.type === 'audio';
        const coverImage = book.cover || (isAudioBook ? 'https://images.unsplash.com/photo-1532012197267-da84d127e765?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80' : 'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80');
        
        html += `
          <div class="col-md-4 col-lg-3">
            <div class="book-card">
              <img src="${coverImage}" alt="${book.title}" class="book-cover">
              <div class="d-flex justify-content-between align-items-start mb-2">
                <h6 class="mb-0">${book.title || ''}</h6>
                <span class="badge ${isAudioBook ? 'bg-info' : 'bg-primary'}">
                  ${isAudioBook ? '<i class="bi bi-headphones me-1"></i>Audio' : '<i class="bi bi-book me-1"></i>Texte'}
                </span>
              </div>
              <p class="text-muted mb-2"><small>Par ${book.author || 'Inconnu'}</small></p>
              ${book.year ? `<p class="mb-1"><small><i class="bi bi-calendar me-1"></i>${book.year}</small></p>` : ''}
              <span class="badge bg-secondary mb-2">${book.category || 'Autre'}</span>
              
              ${isAudioBook ? `
                <div class="audio-player">
                  <audio controls>
                    <source src="${book.url || ''}" type="audio/mpeg">
                    Votre navigateur ne supporte pas l'√©l√©ment audio.
                  </audio>
                  ${book.duration ? `<small class="d-block mt-2 text-center"><i class="bi bi-clock me-1"></i>${book.duration} min</small>` : ''}
                </div>
              ` : `
                <p class="mb-2"><small>${book.description ? book.description.substring(0, 80) + '...' : 'Pas de description'}</small></p>
              `}
              
              <div class="d-flex justify-content-between align-items-center">
                <p class="mb-0"><small><i class="bi bi-people me-1"></i>${book.class || 'Toutes classes'}</small></p>
                <div class="btn-group btn-group-sm">
                  ${isAudioBook ? `
                    <button class="btn btn-outline-info" onclick="playAudioBook('${book.id}')" title="√âcouter">
                      <i class="bi bi-play-fill"></i>
                    </button>
                  ` : `
                    <a href="${book.url || '#'}" target="_blank" class="btn btn-outline-info" title="Lire">
                      <i class="bi bi-eye"></i>
                    </a>
                  `}
                  <button class="btn btn-outline-primary" onclick="${isAudioBook ? 'editAudioBook' : 'editBook'}('${book.id}')" title="Modifier">
                    <i class="bi bi-pencil"></i>
                  </button>
                  <button class="btn btn-outline-danger" onclick="deleteBook('${book.id}')" title="Supprimer">
                    <i class="bi bi-trash"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Filtrer les √©l√®ves
    function filterStudents() {
      const searchTerm = document.getElementById('searchStudent').value.toLowerCase();
      
      filteredStudents = studentsData.filter(student => {
        return (
          (student.name && student.name.toLowerCase().includes(searchTerm)) ||
          (student.class && student.class.toLowerCase().includes(searchTerm)) ||
          (student.parent && student.parent.toLowerCase().includes(searchTerm)) ||
          (student.phone && student.phone.includes(searchTerm))
        );
      });
      
      renderStudents();
    }

    // Filtrer les enseignants
    function filterTeachers() {
      const searchTerm = document.getElementById('searchTeacher').value.toLowerCase();
      
      filteredTeachers = teachersData.filter(teacher => {
        return (
          (teacher.name && teacher.name.toLowerCase().includes(searchTerm)) ||
          (teacher.email && teacher.email.toLowerCase().includes(searchTerm)) ||
          (teacher.subject && teacher.subject.toLowerCase().includes(searchTerm)) ||
          (teacher.phone && teacher.phone.includes(searchTerm))
        );
      });
      
      renderTeachers();
    }

    // Filtrer les livres
    function filterBooks() {
      const searchTerm = document.getElementById('searchBook').value.toLowerCase();
      const filterType = document.getElementById('bookFilter').value;
      
      filteredBooks = booksData.filter(book => {
        const matchesSearch = (
          (book.title && book.title.toLowerCase().includes(searchTerm)) ||
          (book.author && book.author.toLowerCase().includes(searchTerm)) ||
          (book.category && book.category.toLowerCase().includes(searchTerm)) ||
          (book.description && book.description.toLowerCase().includes(searchTerm))
        );
        
        if (!matchesSearch) return false;
        
        if (filterType === 'text') return book.type === 'text';
        if (filterType === 'audio') return book.type === 'audio';
        if (filterType === 'available') return book.status === 'Disponible';
        
        return true; // 'all'
      });
      
      renderBooks();
    }

    // Modal √âl√®ve
    function openAddStudentModal() {
      document.getElementById('studentModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel √âl√®ve';
      document.getElementById('studentForm').reset();
      document.getElementById('studentId').value = '';
      document.getElementById('studentStatus').value = 'Actif';
      
      const modal = new bootstrap.Modal(document.getElementById('studentModal'));
      modal.show();
    }

    function editStudent(id) {
      const student = studentsData.find(s => s.id === id);
      if (!student) return;
      
      document.getElementById('studentModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Modifier l\'√âl√®ve';
      document.getElementById('studentId').value = student.id;
      document.getElementById('studentName').value = student.name || '';
      document.getElementById('studentClass').value = student.class || '';
      document.getElementById('studentGender').value = student.gender || '';
      document.getElementById('studentDOB').value = student.dob || '';
      document.getElementById('studentParent').value = student.parent || '';
      document.getElementById('studentPhone').value = student.phone || '';
      document.getElementById('studentEmail').value = student.parentEmail || '';
      document.getElementById('studentStatus').value = student.status || 'Actif';
      document.getElementById('studentAddress').value = student.address || '';
      document.getElementById('studentNotes').value = student.notes || '';
      
      const modal = new bootstrap.Modal(document.getElementById('studentModal'));
      modal.show();
    }

    document.getElementById('studentForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const studentId = document.getElementById('studentId').value;
      const studentData = {
        name: document.getElementById('studentName').value,
        class: document.getElementById('studentClass').value,
        gender: document.getElementById('studentGender').value,
        dob: document.getElementById('studentDOB').value,
        parent: document.getElementById('studentParent').value,
        phone: document.getElementById('studentPhone').value,
        parentEmail: document.getElementById('studentEmail').value,
        status: document.getElementById('studentStatus').value,
        address: document.getElementById('studentAddress').value,
        notes: document.getElementById('studentNotes').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!studentId) {
        studentData.dateAdded = new Date().toISOString();
        studentData.createdBy = currentUser.email;
      }
      
      let promise;
      if (studentId) {
        promise = database.ref('students/' + studentId).update(studentData);
      } else {
        promise = database.ref('students').push(studentData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('studentModal')).hide();
        showNotification(
          studentId ? '√âl√®ve modifi√© avec succ√®s!' : '√âl√®ve ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteStudent(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer cet √©l√®ve ? Cette action est irr√©versible.')) {
        database.ref('students/' + id).remove()
          .then(() => {
            showNotification('√âl√®ve supprim√© avec succ√®s!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Enseignant
    function openAddTeacherModal() {
      document.getElementById('teacherModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Ajouter un Nouvel Enseignant';
      document.getElementById('teacherForm').reset();
      document.getElementById('teacherId').value = '';
      document.getElementById('teacherStatus').value = 'Actif';
      
      const modal = new bootstrap.Modal(document.getElementById('teacherModal'));
      modal.show();
    }

    function editTeacher(id) {
      const teacher = teachersData.find(t => t.id === id);
      if (!teacher) return;
      
      document.getElementById('teacherModalTitle').innerHTML = '<i class="bi bi-person-plus me-2"></i>Modifier l\'Enseignant';
      document.getElementById('teacherId').value = teacher.id;
      document.getElementById('teacherName').value = teacher.name || '';
      document.getElementById('teacherEmail').value = teacher.email || '';
      document.getElementById('teacherPhone').value = teacher.phone || '';
      document.getElementById('teacherSubject').value = teacher.subject || '';
      document.getElementById('teacherStatus').value = teacher.status || 'Actif';
      document.getElementById('teacherHireDate').value = teacher.hireDate || '';
      document.getElementById('teacherClasses').value = teacher.classes || '';
      document.getElementById('teacherAddress').value = teacher.address || '';
      document.getElementById('teacherQualifications').value = teacher.qualifications || '';
      
      const modal = new bootstrap.Modal(document.getElementById('teacherModal'));
      modal.show();
    }

    document.getElementById('teacherForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const teacherId = document.getElementById('teacherId').value;
      const teacherData = {
        name: document.getElementById('teacherName').value,
        email: document.getElementById('teacherEmail').value,
        phone: document.getElementById('teacherPhone').value,
        subject: document.getElementById('teacherSubject').value,
        status: document.getElementById('teacherStatus').value,
        hireDate: document.getElementById('teacherHireDate').value,
        classes: document.getElementById('teacherClasses').value,
        address: document.getElementById('teacherAddress').value,
        qualifications: document.getElementById('teacherQualifications').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!teacherId) {
        teacherData.dateAdded = new Date().toISOString();
        teacherData.createdBy = currentUser.email;
      }
      
      let promise;
      if (teacherId) {
        promise = database.ref('teachers/' + teacherId).update(teacherData);
      } else {
        promise = database.ref('teachers').push(teacherData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('teacherModal')).hide();
        showNotification(
          teacherId ? 'Enseignant modifi√© avec succ√®s!' : 'Enseignant ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteTeacher(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer cet enseignant ?')) {
        database.ref('teachers/' + id).remove()
          .then(() => {
            showNotification('Enseignant supprim√© avec succ√®s!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Devoir
    function openAddAssignmentModal() {
      document.getElementById('assignmentModalTitle').innerHTML = '<i class="bi bi-clipboard-plus me-2"></i>Ajouter un Devoir';
      document.getElementById('assignmentForm').reset();
      document.getElementById('assignmentId').value = '';
      document.getElementById('assignmentStatus').value = 'Actif';
      document.getElementById('assignmentPoints').value = 20;
      
      const now = new Date();
      const tomorrow = new Date(now);
      tomorrow.setDate(tomorrow.getDate() + 1);
      tomorrow.setHours(17, 0, 0);
      
      document.getElementById('assignmentDueDate').value = tomorrow.toISOString().slice(0, 16);
      
      const modal = new bootstrap.Modal(document.getElementById('assignmentModal'));
      modal.show();
    }

    function editAssignment(id) {
      const assignment = assignmentsData.find(a => a.id === id);
      if (!assignment) return;
      
      document.getElementById('assignmentModalTitle').innerHTML = '<i class="bi bi-clipboard-plus me-2"></i>Modifier le Devoir';
      document.getElementById('assignmentId').value = assignment.id;
      document.getElementById('assignmentTitle').value = assignment.title || '';
      document.getElementById('assignmentClass').value = assignment.class || '';
      document.getElementById('assignmentSubject').value = assignment.subject || '';
      document.getElementById('assignmentDesc').value = assignment.description || '';
      document.getElementById('assignmentInstructions').value = assignment.instructions || '';
      document.getElementById('assignmentPoints').value = assignment.points || 20;
      document.getElementById('assignmentStatus').value = assignment.status || 'Actif';
      
      if (assignment.dueDate) {
        const dueDate = new Date(assignment.dueDate);
        document.getElementById('assignmentDueDate').value = dueDate.toISOString().slice(0, 16);
      }
      
      const modal = new bootstrap.Modal(document.getElementById('assignmentModal'));
      modal.show();
    }

    document.getElementById('assignmentForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const assignmentId = document.getElementById('assignmentId').value;
      const assignmentData = {
        title: document.getElementById('assignmentTitle').value,
        class: document.getElementById('assignmentClass').value,
        subject: document.getElementById('assignmentSubject').value,
        description: document.getElementById('assignmentDesc').value,
        instructions: document.getElementById('assignmentInstructions').value,
        dueDate: document.getElementById('assignmentDueDate').value,
        points: document.getElementById('assignmentPoints').value,
        status: document.getElementById('assignmentStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!assignmentId) {
        assignmentData.dateAdded = new Date().toISOString();
        assignmentData.createdBy = currentUser.email;
      }
      
      let promise;
      if (assignmentId) {
        promise = database.ref('assignments/' + assignmentId).update(assignmentData);
      } else {
        promise = database.ref('assignments').push(assignmentData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('assignmentModal')).hide();
        showNotification(
          assignmentId ? 'Devoir modifi√© avec succ√®s!' : 'Devoir ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteAssignment(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer ce devoir ?')) {
        database.ref('assignments/' + id).remove()
          .then(() => {
            showNotification('Devoir supprim√© avec succ√®s!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Test
    function openAddTestModal() {
      document.getElementById('testModalTitle').innerHTML = '<i class="bi bi-file-plus me-2"></i>Ajouter un Test';
      document.getElementById('testForm').reset();
      document.getElementById('testId').value = '';
      document.getElementById('testStatus').value = 'Planifi√©';
      document.getElementById('testDuration').value = 60;
      document.getElementById('testMaxScore').value = 20;
      document.getElementById('testType').value = 'Contr√¥le';
      
      const now = new Date();
      const nextWeek = new Date(now);
      nextWeek.setDate(nextWeek.getDate() + 7);
      nextWeek.setHours(9, 0, 0);
      
      document.getElementById('testDate').value = nextWeek.toISOString().slice(0, 16);
      
      const modal = new bootstrap.Modal(document.getElementById('testModal'));
      modal.show();
    }

    function editTest(id) {
      const test = testsData.find(t => t.id === id);
      if (!test) return;
      
      document.getElementById('testModalTitle').innerHTML = '<i class="bi bi-file-plus me-2"></i>Modifier le Test';
      document.getElementById('testId').value = test.id;
      document.getElementById('testTitle').value = test.title || '';
      document.getElementById('testClass').value = test.class || '';
      document.getElementById('testSubject').value = test.subject || '';
      document.getElementById('testDescription').value = test.description || '';
      document.getElementById('testDuration').value = test.duration || 60;
      document.getElementById('testMaxScore').value = test.maxScore || 20;
      document.getElementById('testType').value = test.type || 'Contr√¥le';
      document.getElementById('testStatus').value = test.status || 'Planifi√©';
      
      if (test.date) {
        const testDate = new Date(test.date);
        document.getElementById('testDate').value = testDate.toISOString().slice(0, 16);
      }
      
      const modal = new bootstrap.Modal(document.getElementById('testModal'));
      modal.show();
    }

    document.getElementById('testForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const testId = document.getElementById('testId').value;
      const testData = {
        title: document.getElementById('testTitle').value,
        class: document.getElementById('testClass').value,
        subject: document.getElementById('testSubject').value,
        description: document.getElementById('testDescription').value,
        date: document.getElementById('testDate').value,
        duration: document.getElementById('testDuration').value,
        maxScore: document.getElementById('testMaxScore').value,
        type: document.getElementById('testType').value,
        status: document.getElementById('testStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!testId) {
        testData.dateAdded = new Date().toISOString();
        testData.createdBy = currentUser.email;
      }
      
      let promise;
      if (testId) {
        promise = database.ref('tests/' + testId).update(testData);
      } else {
        promise = database.ref('tests').push(testData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('testModal')).hide();
        showNotification(
          testId ? 'Test modifi√© avec succ√®s!' : 'Test ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteTest(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer ce test ?')) {
        database.ref('tests/' + id).remove()
          .then(() => {
            showNotification('Test supprim√© avec succ√®s!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Examen
    function openAddExamModal() {
      document.getElementById('examModalTitle').innerHTML = '<i class="bi bi-pen-plus me-2"></i>Ajouter un Examen';
      document.getElementById('examForm').reset();
      document.getElementById('examId').value = '';
      document.getElementById('examStatus').value = 'Planifi√©';
      document.getElementById('examDuration').value = 120;
      document.getElementById('examCoefficient').value = 1;
      document.getElementById('examType').value = 'Partiel';
      
      const now = new Date();
      const twoWeeks = new Date(now);
      twoWeeks.setDate(twoWeeks.getDate() + 14);
      twoWeeks.setHours(9, 0, 0);
      
      document.getElementById('examDate').value = twoWeeks.toISOString().slice(0, 16);
      
      const modal = new bootstrap.Modal(document.getElementById('examModal'));
      modal.show();
    }

    function editExam(id) {
      const exam = examsData.find(e => e.id === id);
      if (!exam) return;
      
      document.getElementById('examModalTitle').innerHTML = '<i class="bi bi-pen-plus me-2"></i>Modifier l\'Examen';
      document.getElementById('examId').value = exam.id;
      document.getElementById('examTitle').value = exam.title || '';
      document.getElementById('examClass').value = exam.class || '';
      document.getElementById('examSubject').value = exam.subject || '';
      document.getElementById('examDescription').value = exam.description || '';
      document.getElementById('examDuration').value = exam.duration || 120;
      document.getElementById('examCoefficient').value = exam.coefficient || 1;
      document.getElementById('examType').value = exam.type || 'Partiel';
      document.getElementById('examStatus').value = exam.status || 'Planifi√©';
      
      if (exam.date) {
        const examDate = new Date(exam.date);
        document.getElementById('examDate').value = examDate.toISOString().slice(0, 16);
      }
      
      const modal = new bootstrap.Modal(document.getElementById('examModal'));
      modal.show();
    }

    document.getElementById('examForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const examId = document.getElementById('examId').value;
      const examData = {
        title: document.getElementById('examTitle').value,
        class: document.getElementById('examClass').value,
        subject: document.getElementById('examSubject').value,
        description: document.getElementById('examDescription').value,
        date: document.getElementById('examDate').value,
        duration: document.getElementById('examDuration').value,
        coefficient: document.getElementById('examCoefficient').value,
        type: document.getElementById('examType').value,
        status: document.getElementById('examStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!examId) {
        examData.dateAdded = new Date().toISOString();
        examData.createdBy = currentUser.email;
      }
      
      let promise;
      if (examId) {
        promise = database.ref('exams/' + examId).update(examData);
      } else {
        promise = database.ref('exams').push(examData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('examModal')).hide();
        showNotification(
          examId ? 'Examen modifi√© avec succ√®s!' : 'Examen ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteExam(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer cet examen ?')) {
        database.ref('exams/' + id).remove()
          .then(() => {
            showNotification('Examen supprim√© avec succ√®s!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Travail de Vacances
    function openAddVacationWorkModal() {
      document.getElementById('vacationWorkModalTitle').innerHTML = '<i class="bi bi-sun-plus me-2"></i>Ajouter un Travail de Vacances';
      document.getElementById('vacationWorkForm').reset();
      document.getElementById('vacationWorkId').value = '';
      document.getElementById('vacationWorkStatus').value = 'Actif';
      document.getElementById('vacationWorkPeriod').value = 'Vacances de No√´l 2023';
      
      const now = new Date();
      const startDate = new Date(now);
      startDate.setDate(startDate.getDate() + 1);
      const endDate = new Date(now);
      endDate.setDate(endDate.getDate() + 15);
      
      document.getElementById('vacationWorkStartDate').value = startDate.toISOString().slice(0, 10);
      document.getElementById('vacationWorkEndDate').value = endDate.toISOString().slice(0, 10);
      
      const modal = new bootstrap.Modal(document.getElementById('vacationWorkModal'));
      modal.show();
    }

    function editVacationWork(id) {
      const work = vacationWorksData.find(w => w.id === id);
      if (!work) return;
      
      document.getElementById('vacationWorkModalTitle').innerHTML = '<i class="bi bi-sun-plus me-2"></i>Modifier le Travail de Vacances';
      document.getElementById('vacationWorkId').value = work.id;
      document.getElementById('vacationWorkTitle').value = work.title || '';
      document.getElementById('vacationWorkClass').value = work.class || '';
      document.getElementById('vacationWorkSubject').value = work.subject || '';
      document.getElementById('vacationWorkPeriod').value = work.period || '';
      document.getElementById('vacationWorkDescription').value = work.description || '';
      document.getElementById('vacationWorkInstructions').value = work.instructions || '';
      document.getElementById('vacationWorkFiles').value = work.files || '';
      document.getElementById('vacationWorkStatus').value = work.status || 'Actif';
      document.getElementById('vacationWorkStartDate').value = work.startDate || '';
      document.getElementById('vacationWorkEndDate').value = work.endDate || '';
      
      const modal = new bootstrap.Modal(document.getElementById('vacationWorkModal'));
      modal.show();
    }

    document.getElementById('vacationWorkForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const vacationWorkId = document.getElementById('vacationWorkId').value;
      const vacationWorkData = {
        title: document.getElementById('vacationWorkTitle').value,
        class: document.getElementById('vacationWorkClass').value,
        subject: document.getElementById('vacationWorkSubject').value,
        period: document.getElementById('vacationWorkPeriod').value,
        description: document.getElementById('vacationWorkDescription').value,
        instructions: document.getElementById('vacationWorkInstructions').value,
        files: document.getElementById('vacationWorkFiles').value,
        startDate: document.getElementById('vacationWorkStartDate').value,
        endDate: document.getElementById('vacationWorkEndDate').value,
        status: document.getElementById('vacationWorkStatus').value,
        updatedAt: new Date().toISOString()
      };
      
      if (!vacationWorkId) {
        vacationWorkData.dateAdded = new Date().toISOString();
        vacationWorkData.createdBy = currentUser.email;
      }
      
      let promise;
      if (vacationWorkId) {
        promise = database.ref('vacationWorks/' + vacationWorkId).update(vacationWorkData);
      } else {
        promise = database.ref('vacationWorks').push(vacationWorkData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('vacationWorkModal')).hide();
        showNotification(
          vacationWorkId ? 'Travail de vacances modifi√© avec succ√®s!' : 'Travail de vacances ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteVacationWork(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer ce travail de vacances ?')) {
        database.ref('vacationWorks/' + id).remove()
          .then(() => {
            showNotification('Travail de vacances supprim√© avec succ√®s!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Modal Livre Texte
    function openAddBookModal() {
      document.getElementById('bookModalTitle').innerHTML = '<i class="bi bi-book-fill me-2"></i>Ajouter un Livre';
      document.getElementById('bookForm').reset();
      document.getElementById('bookId').value = '';
      document.getElementById('bookStatus').value = 'Disponible';
      document.getElementById('bookLanguage').value = 'Fran√ßais';
      document.getElementById('bookYear').value = new Date().getFullYear();
      document.getElementById('bookClass').value = 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('bookModal'));
      modal.show();
    }

    function editBook(id) {
      const book = booksData.find(b => b.id === id);
      if (!book) return;
      
      document.getElementById('bookModalTitle').innerHTML = '<i class="bi bi-book-fill me-2"></i>Modifier le Livre';
      document.getElementById('bookId').value = book.id;
      document.getElementById('bookTitle').value = book.title || '';
      document.getElementById('bookAuthor').value = book.author || '';
      document.getElementById('bookCategory').value = book.category || '';
      document.getElementById('bookISBN').value = book.isbn || '';
      document.getElementById('bookYear').value = book.year || '';
      document.getElementById('bookDescription').value = book.description || '';
      document.getElementById('bookUrl').value = book.url || '';
      document.getElementById('bookCover').value = book.cover || '';
      document.getElementById('bookLanguage').value = book.language || 'Fran√ßais';
      document.getElementById('bookStatus').value = book.status || 'Disponible';
      document.getElementById('bookClass').value = book.class || 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('bookModal'));
      modal.show();
    }

    document.getElementById('bookForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const bookId = document.getElementById('bookId').value;
      const bookData = {
        title: document.getElementById('bookTitle').value,
        author: document.getElementById('bookAuthor').value,
        category: document.getElementById('bookCategory').value,
        isbn: document.getElementById('bookISBN').value,
        year: document.getElementById('bookYear').value,
        description: document.getElementById('bookDescription').value,
        url: document.getElementById('bookUrl').value,
        cover: document.getElementById('bookCover').value,
        language: document.getElementById('bookLanguage').value,
        status: document.getElementById('bookStatus').value,
        class: document.getElementById('bookClass').value,
        type: 'text',
        updatedAt: new Date().toISOString()
      };
      
      if (!bookId) {
        bookData.dateAdded = new Date().toISOString();
        bookData.createdBy = currentUser.email;
      }
      
      let promise;
      if (bookId) {
        promise = database.ref('books/' + bookId).update(bookData);
      } else {
        promise = database.ref('books').push(bookData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('bookModal')).hide();
        showNotification(
          bookId ? 'Livre modifi√© avec succ√®s!' : 'Livre ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    // Modal Livre Audio
    function openAddAudioBookModal() {
      document.getElementById('audioBookModalTitle').innerHTML = '<i class="bi bi-headphones me-2"></i>Ajouter un Livre Audio';
      document.getElementById('audioBookForm').reset();
      document.getElementById('audioBookId').value = '';
      document.getElementById('audioBookStatus').value = 'Disponible';
      document.getElementById('audioBookLanguage').value = 'Fran√ßais';
      document.getElementById('audioBookYear').value = new Date().getFullYear();
      document.getElementById('audioBookClass').value = 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('audioBookModal'));
      modal.show();
    }

    function editAudioBook(id) {
      const book = booksData.find(b => b.id === id);
      if (!book) return;
      
      document.getElementById('audioBookModalTitle').innerHTML = '<i class="bi bi-headphones me-2"></i>Modifier le Livre Audio';
      document.getElementById('audioBookId').value = book.id;
      document.getElementById('audioBookTitle').value = book.title || '';
      document.getElementById('audioBookAuthor').value = book.author || '';
      document.getElementById('audioBookCategory').value = book.category || '';
      document.getElementById('audioBookDuration').value = book.duration || '';
      document.getElementById('audioBookYear').value = book.year || '';
      document.getElementById('audioBookDescription').value = book.description || '';
      document.getElementById('audioBookUrl').value = book.url || '';
      document.getElementById('audioBookCover').value = book.cover || '';
      document.getElementById('audioBookLanguage').value = book.language || 'Fran√ßais';
      document.getElementById('audioBookStatus').value = book.status || 'Disponible';
      document.getElementById('audioBookClass').value = book.class || 'Toutes';
      
      const modal = new bootstrap.Modal(document.getElementById('audioBookModal'));
      modal.show();
    }

    document.getElementById('audioBookForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const audioBookId = document.getElementById('audioBookId').value;
      const audioBookData = {
        title: document.getElementById('audioBookTitle').value,
        author: document.getElementById('audioBookAuthor').value,
        category: document.getElementById('audioBookCategory').value,
        duration: document.getElementById('audioBookDuration').value,
        year: document.getElementById('audioBookYear').value,
        description: document.getElementById('audioBookDescription').value,
        url: document.getElementById('audioBookUrl').value,
        cover: document.getElementById('audioBookCover').value,
        language: document.getElementById('audioBookLanguage').value,
        status: document.getElementById('audioBookStatus').value,
        class: document.getElementById('audioBookClass').value,
        type: 'audio',
        updatedAt: new Date().toISOString()
      };
      
      if (!audioBookId) {
        audioBookData.dateAdded = new Date().toISOString();
        audioBookData.createdBy = currentUser.email;
      }
      
      let promise;
      if (audioBookId) {
        promise = database.ref('books/' + audioBookId).update(audioBookData);
      } else {
        promise = database.ref('books').push(audioBookData);
      }
      
      promise.then(() => {
        bootstrap.Modal.getInstance(document.getElementById('audioBookModal')).hide();
        showNotification(
          audioBookId ? 'Livre audio modifi√© avec succ√®s!' : 'Livre audio ajout√© avec succ√®s!',
          'success'
        );
      }).catch((error) => {
        showNotification('Erreur: ' + error.message, 'danger');
      });
    });

    function deleteBook(id) {
      if (confirm('√ätes-vous s√ªr de vouloir supprimer ce livre ?')) {
        database.ref('books/' + id).remove()
          .then(() => {
            showNotification('Livre supprim√© avec succ√®s!', 'success');
          })
          .catch((error) => {
            showNotification('Erreur: ' + error.message, 'danger');
          });
      }
    }

    // Fonction pour jouer un livre audio
    function playAudioBook(id) {
      const book = booksData.find(b => b.id === id);
      if (!book || !book.url) return;
      
      // Ouvrir le lecteur audio dans une nouvelle fen√™tre
      window.open(book.url, '_blank');
    }

    // Fonctions d'affichage (view)
    function viewStudent(id) {
      const student = studentsData.find(s => s.id === id);
      if (!student) return;
      
      let details = `
        <h5>${student.name || ''}</h5>
        <p><strong>Classe:</strong> ${student.class || ''}</p>
        <p><strong>Sexe:</strong> ${student.gender || ''}</p>
        <p><strong>Date de naissance:</strong> ${student.dob ? new Date(student.dob).toLocaleDateString('fr-FR') : '-'}</p>
        <p><strong>Parent:</strong> ${student.parent || ''}</p>
        <p><strong>T√©l√©phone:</strong> ${student.phone || ''}</p>
        <p><strong>Email:</strong> ${student.parentEmail || '-'}</p>
        <p><strong>Adresse:</strong> ${student.address || '-'}</p>
        <p><strong>Statut:</strong> ${student.status || 'Actif'}</p>
        ${student.notes ? `<p><strong>Remarques:</strong> ${student.notes}</p>` : ''}
      `;
      
      showNotification(details, 'info');
    }

    function viewTeacher(id) {
      const teacher = teachersData.find(t => t.id === id);
      if (!teacher) return;
      
      let details = `
        <h5>${teacher.name || ''}</h5>
        <p><strong>Email:</strong> ${teacher.email || ''}</p>
        <p><strong>T√©l√©phone:</strong> ${teacher.phone || ''}</p>
        <p><strong>Mati√®re:</strong> ${teacher.subject || ''}</p>
        <p><strong>Classes:</strong> ${teacher.classes || ''}</p>
        <p><strong>Statut:</strong> ${teacher.status || 'Actif'}</p>
        <p><strong>Date d'embauche:</strong> ${teacher.hireDate ? new Date(teacher.hireDate).toLocaleDateString('fr-FR') : '-'}</p>
        <p><strong>Adresse:</strong> ${teacher.address || '-'}</p>
        ${teacher.qualifications ? `<p><strong>Qualifications:</strong> ${teacher.qualifications}</p>` : ''}
      `;
      
      showNotification(details, 'info');
    }

    // Afficher une notification
    function showNotification(message, type = 'info') {
      const notification = document.getElementById('notification');
      const title = document.getElementById('notification-title');
      const messageEl = document.getElementById('notification-message');
      
      notification.className = 'alert-notification alert';
      if (type === 'success') {
        notification.classList.add('alert-success');
        title.textContent = 'Succ√®s!';
      } else if (type === 'danger') {
        notification.classList.add('alert-danger');
        title.textContent = 'Erreur!';
      } else if (type === 'warning') {
        notification.classList.add('alert-warning');
        title.textContent = 'Attention!';
      } else {
        notification.classList.add('alert-info');
        title.textContent = 'Information';
      }
      
      messageEl.innerHTML = message;
      notification.style.display = 'block';
      
      setTimeout(() => {
        notification.classList.add('show');
      }, 10);
      
      setTimeout(() => {
        hideNotification();
      }, 5000);
    }

    function hideNotification() {
      const notification = document.getElementById('notification');
      notification.classList.remove('show');
      setTimeout(() => {
        notification.style.display = 'none';
      }, 300);
    }

    // D√©connexion
    function logout() {
      if (confirm('Voulez-vous vraiment vous d√©connecter ?')) {
        auth.signOut().then(() => {
          window.location.href = 'Auth.html';
        }).catch((error) => {
          showNotification('Erreur lors de la d√©connexion: ' + error.message, 'danger');
        });
      }
    }

    // ===== INSCRIPTION SECRETARY =====
    const BRANCHES_DATA_SEC = {
      KACYIRU: { name: "Kacyiru", phone: "0791639766 / 0792570074", email: "sergetumbwe@gmail.com", address: "KG 17 Ave, Kacyiru, Kigali" },
      GISOZI: { name: "Gisozi", phone: "0788410242 / 0796145647", email: "gisozi@edenfamily.edu.rw", address: "KG 11 Ave, Gisozi, Kigali" },
      KIMISAGARA: { name: "Kimisagara", phone: "0785892018 / 0791826950", email: "kimisagara@edenfamily.edu.rw", address: "KG 7 Ave, Kimisagara, Kigali" }
    };

    function updateSectionSec() {
      const section = document.querySelector('input[name="section"]:checked').value;
      if (section === 'MATERNELLE') {
        document.getElementById('niveauMaternelleGroupSec').style.display = 'block';
        document.getElementById('niveauPrimaireGroupSec').style.display = 'none';
        document.getElementById('sdmsGroupSec').style.display = 'none';
      } else {
        document.getElementById('niveauMaternelleGroupSec').style.display = 'none';
        document.getElementById('niveauPrimaireGroupSec').style.display = 'block';
        document.getElementById('sdmsGroupSec').style.display = 'block';
      }
    }

    function updateContactInfoSec() {
      const branche = document.querySelector('input[name="branche"]:checked').value;
      const contactInfo = document.getElementById('contactInfoSec');
      const contactText = document.getElementById('contactTextSec');
      const branchData = BRANCHES_DATA_SEC[branche];
      
      if (branchData) {
        contactText.innerHTML = `
          <strong>Contact ${branchData.name}:</strong><br>
          <i class="bi bi-telephone"></i> ${branchData.phone}<br>
          <i class="bi bi-envelope"></i> ${branchData.email}<br>
          <i class="bi bi-geo-alt"></i> ${branchData.address}
        `;
        contactInfo.style.display = 'block';
      }
    }

    function generateStudentCodeSec() {
      const now = new Date();
      const timestamp = now.getTime();
      const random = Math.floor(Math.random() * 1000);
      return `EDU-${now.getFullYear()}${(now.getMonth() + 1).toString().padStart(2, '0')}${now.getDate().toString().padStart(2, '0')}-${timestamp.toString().slice(-6)}${random.toString().padStart(3, '0')}`;
    }

    function validateSecretaryInscription() {
      let isValid = true;
      const requiredFields = ['nomPrenomSec', 'dateNaissanceSec', 'ecoleProvenanceSec', 'villeSec', 'secteurSec', 'umurengeSec', 'akagariSec', 'umuduguduSec', 'chefNomPrenomSec', 'chefTelephoneSec', 'chefPieceIdentiteSec'];
      
      requiredFields.forEach(fieldId => {
        const field = document.getElementById(fieldId);
        const errorId = fieldId + 'Error';
        if (!field.value.trim()) {
          isValid = false;
          const errorEl = document.getElementById(errorId);
          if (errorEl) {
            errorEl.textContent = 'Ce champ est requis';
            errorEl.style.display = 'block';
          }
        }
      });
      
      if (!document.querySelector('input[name="sexe"]:checked')) {
        isValid = false;
        document.getElementById('sexeErrorSec').textContent = 'Ce champ est requis';
        document.getElementById('sexeErrorSec').style.display = 'block';
      }
      
      const section = document.querySelector('input[name="section"]:checked');
      if (!section) {
        isValid = false;
        document.getElementById('sectionErrorSec').textContent = 'Ce champ est requis';
        document.getElementById('sectionErrorSec').style.display = 'block';
      }
      
      if (!document.querySelector('input[name="branche"]:checked')) {
        isValid = false;
        document.getElementById('brancheErrorSec').textContent = 'Ce champ est requis';
        document.getElementById('brancheErrorSec').style.display = 'block';
      }
      
      if (!document.querySelector('input[name="transport"]:checked')) {
        isValid = false;
        document.getElementById('transportErrorSec').textContent = 'Ce champ est requis';
        document.getElementById('transportErrorSec').style.display = 'block';
      }
      
      return isValid;
    }

    async function submitSecretaryInscription() {
      if (!validateSecretaryInscription()) {
        showNotification('Veuillez remplir tous les champs obligatoires', 'danger');
        return;
      }
      
      const formData = {
        nomPrenom: document.getElementById('nomPrenomSec').value,
        dateNaissance: document.getElementById('dateNaissanceSec').value,
        ecoleProvenance: document.getElementById('ecoleProvenanceSec').value,
        sexe: document.querySelector('input[name="sexe"]:checked').value,
        section: document.querySelector('input[name="section"]:checked').value,
        niveau: document.querySelector('input[name="section"]:checked').value === 'MATERNELLE' ? document.getElementById('niveauMaternelleSec').value : document.getElementById('niveauPrimaireSec').value,
        sdmsCode: document.getElementById('sdmsCodeSec').value || null,
        branche: document.querySelector('input[name="branche"]:checked').value,
        transport: document.querySelector('input[name="transport"]:checked').value,
        chefNomPrenom: document.getElementById('chefNomPrenomSec').value,
        chefTelephone: document.getElementById('chefTelephoneSec').value,
        chefPieceIdentite: document.getElementById('chefPieceIdentiteSec').value,
        conjointNomPrenom: document.getElementById('conjointNomPrenomSec').value || null,
        conjointTelephone: document.getElementById('conjointTelephoneSec').value || null,
        conjointPieceIdentite: document.getElementById('conjointPieceIdentiteSec').value || null,
        ville: document.getElementById('villeSec').value,
        secteur: document.getElementById('secteurSec').value,
        umurenge: document.getElementById('umurengeSec').value,
        akagari: document.getElementById('akagariSec').value,
        umudugudu: document.getElementById('umuduguduSec').value,
        codeUnique: generateStudentCodeSec(),
        dateInscription: new Date().toISOString(),
        timestamp: Date.now(),
        statut: 'En attente de validation'
      };
      
      try {
        await database.ref('inscriptions-scolaires').push(formData);
        showNotification(`Inscription enregistr√©e! Code: ${formData.codeUnique}`, 'success');
        document.getElementById('inscriptionFormSecretary').reset();
      } catch (error) {
        showNotification('Erreur: ' + error.message, 'danger');
      }
    }

    // Initialisation au chargement
    document.addEventListener('DOMContentLoaded', function() {
      // V√©rifier l'authentification
      auth.onAuthStateChanged((user) => {
        if (!user) {
          window.location.href = 'Auth.html';
        }
      });
    });
  </script>
</body>
</html>